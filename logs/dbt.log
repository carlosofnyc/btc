[0m17:25:02.392246 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:25:02.406256 | 7645752c-d99a-4f0f-be59-63a2b37c5afe ==============================
[0m17:25:02.406256 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:25:02.406865 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'no_print': 'None', 'debug': 'False', 'empty': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m17:25:02.414237 [info ] [MainThread]: dbt version: 1.10.11
[0m17:25:02.414474 [info ] [MainThread]: python version: 3.12.0
[0m17:25:02.414648 [info ] [MainThread]: python path: /Users/mac/Desktop/DE2025/btc/venv/bin/python
[0m17:25:02.414814 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m17:25:03.599538 [info ] [MainThread]: Using profiles dir at /Users/mac/.dbt
[0m17:25:03.599897 [info ] [MainThread]: Using profiles.yml file at /Users/mac/.dbt/profiles.yml
[0m17:25:03.600105 [info ] [MainThread]: Using dbt_project.yml file at /Users/mac/Desktop/DE2025/btc/dbt_project.yml
[0m17:25:03.600457 [info ] [MainThread]: adapter type: snowflake
[0m17:25:03.600646 [info ] [MainThread]: adapter version: 1.10.2
[0m17:25:03.661796 [info ] [MainThread]: Configuration:
[0m17:25:03.662152 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:25:03.662349 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:25:03.662529 [info ] [MainThread]: Required dependencies:
[0m17:25:03.662849 [debug] [MainThread]: Executing "git --help"
[0m17:25:03.673340 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:25:03.673997 [debug] [MainThread]: STDERR: "b''"
[0m17:25:03.674273 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:25:03.674523 [info ] [MainThread]: Connection:
[0m17:25:03.674754 [info ] [MainThread]:   account: KTPPEJB-WW82576
[0m17:25:03.674949 [info ] [MainThread]:   user: carlos
[0m17:25:03.675183 [info ] [MainThread]:   database: btc
[0m17:25:03.675410 [info ] [MainThread]:   warehouse: btc
[0m17:25:03.675609 [info ] [MainThread]:   role: accountadmin
[0m17:25:03.675814 [info ] [MainThread]:   schema: btc_schema
[0m17:25:03.676094 [info ] [MainThread]:   authenticator: None
[0m17:25:03.676320 [info ] [MainThread]:   oauth_client_id: None
[0m17:25:03.676506 [info ] [MainThread]:   query_tag: None
[0m17:25:03.676662 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:25:03.676831 [info ] [MainThread]:   host: None
[0m17:25:03.676991 [info ] [MainThread]:   port: None
[0m17:25:03.677145 [info ] [MainThread]:   proxy_host: None
[0m17:25:03.677300 [info ] [MainThread]:   proxy_port: None
[0m17:25:03.677456 [info ] [MainThread]:   protocol: None
[0m17:25:03.677600 [info ] [MainThread]:   connect_retries: 1
[0m17:25:03.677743 [info ] [MainThread]:   connect_timeout: None
[0m17:25:03.677889 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:25:03.678035 [info ] [MainThread]:   retry_all: False
[0m17:25:03.678176 [info ] [MainThread]:   insecure_mode: False
[0m17:25:03.678323 [info ] [MainThread]:   reuse_connections: True
[0m17:25:03.678472 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m17:25:03.678837 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:25:03.814013 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:25:03.846243 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:25:03.846472 [debug] [MainThread]: On debug: select 1 as id
[0m17:25:03.846645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:07.239242 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.393 seconds
[0m17:25:07.239977 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:25:07.240216 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:25:07.242316 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.8799286, "process_in_blocks": "0", "process_kernel_time": 0.347837, "process_mem_max_rss": "159989760", "process_out_blocks": "0", "process_user_time": 1.207949}
[0m17:25:07.242684 [debug] [MainThread]: Command `dbt debug` succeeded at 17:25:07.242620 after 4.88 seconds
[0m17:25:07.242926 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:25:07.243131 [debug] [MainThread]: On debug: Close
[0m17:25:07.336973 [debug] [MainThread]: Flushing usage events
[0m17:34:03.539962 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:34:03.551004 | 01ac48ef-6b8b-4c0a-8671-0530e1ac2856 ==============================
[0m17:34:03.551004 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:34:03.551569 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'no_print': 'None'}
[0m17:34:03.620840 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:34:03.621285 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:34:03.623336 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11240679, "process_in_blocks": "0", "process_kernel_time": 0.096128, "process_mem_max_rss": "111394816", "process_out_blocks": "0", "process_user_time": 0.76092}
[0m17:34:03.623728 [debug] [MainThread]: Command `cli deps` succeeded at 17:34:03.623670 after 0.11 seconds
[0m17:34:03.623928 [debug] [MainThread]: Flushing usage events
[0m17:35:18.815991 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:35:18.826294 | 8928441c-3d87-4c7e-be35-b52c8ae27004 ==============================
[0m17:35:18.826294 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:35:18.826801 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'version_check': 'True', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'empty': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/mac/.dbt'}
[0m17:35:19.036183 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:35:19.106236 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:35:19.157385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:35:19.157602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:35:19.186298 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m17:35:19.238270 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:35:19.239646 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:35:19.247505 [info ] [MainThread]: Found 1 model, 1 source, 479 macros
[0m17:35:19.248356 [info ] [MainThread]: 
[0m17:35:19.248562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:19.248722 [info ] [MainThread]: 
[0m17:35:19.249001 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:35:19.249475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc_btc_schema'
[0m17:35:19.283743 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m17:35:19.283979 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m17:35:19.284145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:20.867252 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.583 seconds
[0m17:35:20.872355 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m17:35:20.875664 [debug] [Thread-1 (]: Began running node source.btc.btc.btc
[0m17:35:20.876207 [info ] [Thread-1 (]: 1 of 1 START freshness of btc.btc .............................................. [RUN]
[0m17:35:20.876755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now source.btc.btc.btc)
[0m17:35:20.877191 [debug] [Thread-1 (]: Began compiling node source.btc.btc.btc
[0m17:35:20.877614 [debug] [Thread-1 (]: Began executing node source.btc.btc.btc
[0m17:35:20.893764 [debug] [Thread-1 (]: Using snowflake connection "source.btc.btc.btc"
[0m17:35:20.894315 [debug] [Thread-1 (]: On source.btc.btc.btc: select
      max(BLOCK_TIMESTAMP) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from btc.btc_schema.btc
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "source.btc.btc.btc"} */
[0m17:35:21.673547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m17:35:21.679385 [warn ] [Thread-1 (]: 1 of 1 WARN freshness of btc.btc ............................................... [[33mWARN[0m in 0.80s]
[0m17:35:21.680354 [debug] [Thread-1 (]: Finished running node source.btc.btc.btc
[0m17:35:21.682452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:21.682984 [debug] [MainThread]: Connection 'source.btc.btc.btc' was left open.
[0m17:35:21.683467 [debug] [MainThread]: On source.btc.btc.btc: Close
[0m17:35:21.779003 [info ] [MainThread]: 
[0m17:35:21.779811 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m17:35:21.807029 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:35:21.809296 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:35:21.814107 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/mac/Desktop/DE2025/btc/target/sources.json
[0m17:35:21.814427 [info ] [MainThread]: Done.
[0m17:35:21.816634 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 3.0261087, "process_in_blocks": "0", "process_kernel_time": 0.199895, "process_mem_max_rss": "163627008", "process_out_blocks": "0", "process_user_time": 1.306098}
[0m17:35:21.817086 [debug] [MainThread]: Command `dbt source freshness` succeeded at 17:35:21.817016 after 3.03 seconds
[0m17:35:21.817399 [debug] [MainThread]: Flushing usage events
[0m17:54:46.605239 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:54:46.618235 | 03c0fbb8-21ab-46de-83ce-0c55bdab3cfb ==============================
[0m17:54:46.618235 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:54:46.618791 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/mac/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt test', 'debug': 'False', 'quiet': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m17:54:46.863313 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:54:46.934757 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:54:46.979030 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading btc: schema.yml - Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |   - name: stg_btc
    5  |     columns:
    6  |       - name: HASHKEY
    7  |       tests:
    8  |         - unique
    9  |         - not_null
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 6, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 7, column 7
[0m17:54:46.981020 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.40167367, "process_in_blocks": "0", "process_kernel_time": 0.14558, "process_mem_max_rss": "136740864", "process_out_blocks": "0", "process_user_time": 0.949566}
[0m17:54:46.981365 [debug] [MainThread]: Command `dbt test` failed at 17:54:46.981316 after 0.40 seconds
[0m17:54:46.981570 [debug] [MainThread]: Flushing usage events
[0m17:55:50.829924 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:55:50.841050 | 8b8f3566-5f3e-4af9-b1a3-677be9c519c1 ==============================
[0m17:55:50.841050 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:55:50.841607 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/Users/mac/.dbt', 'use_experimental_parser': 'False', 'version_check': 'True', 'use_colors': 'True', 'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt run -m stg_btc', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'log_format': 'default'}
[0m17:55:50.841870 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:55:51.054318 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:55:51.122847 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:55:51.166589 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading btc: schema.yml - Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |   - name: stg_btc
    5  |     columns:
    6  |       - name: HASHKEY
    7  |       tests:
    8  |         - unique
    9  |         - not_null
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 6, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 7, column 7
[0m17:55:51.166992 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:55:51.168474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.36427066, "process_in_blocks": "0", "process_kernel_time": 0.143683, "process_mem_max_rss": "136806400", "process_out_blocks": "0", "process_user_time": 0.941915}
[0m17:55:51.168802 [debug] [MainThread]: Command `dbt run` failed at 17:55:51.168748 after 0.36 seconds
[0m17:55:51.169010 [debug] [MainThread]: Flushing usage events
[0m17:57:51.154295 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:57:51.167123 | 2708250b-1323-4ad3-b422-f007f3f411a2 ==============================
[0m17:57:51.167123 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:57:51.167716 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -m stg_btc', 'warn_error': 'None', 'profiles_dir': '/Users/mac/.dbt', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None'}
[0m17:57:51.168020 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:57:51.386191 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:57:51.456260 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:57:51.546514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:51.546786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:51.549604 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m17:57:51.613303 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:57:51.614340 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:57:51.621500 [info ] [MainThread]: Found 1 model, 2 data tests, 1 source, 479 macros
[0m17:57:51.622290 [info ] [MainThread]: 
[0m17:57:51.622512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:51.622673 [info ] [MainThread]: 
[0m17:57:51.622933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:57:51.623356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m17:57:51.655632 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m17:57:51.655887 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m17:57:51.656070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:52.792013 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.136 seconds
[0m17:57:52.795266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m17:57:52.810436 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m17:57:52.810865 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m17:57:52.932818 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m17:57:52.941742 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m17:57:52.942590 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc ................................. [RUN]
[0m17:57:52.943289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m17:57:52.944063 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m17:57:52.952580 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m17:57:52.953714 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m17:57:52.979598 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m17:57:52.980572 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m17:57:52.980867 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace   view btc.btc_schema.stg_btc
  
  
  
  
  as (
    select top 1 *
from btc.btc_schema.btc
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m17:57:53.190330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m17:57:53.221691 [info ] [Thread-1 (]: 1 of 1 OK created sql view model btc_schema.stg_btc ............................ [[32mSUCCESS 1[0m in 0.28s]
[0m17:57:53.222342 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m17:57:53.223575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:53.223891 [debug] [MainThread]: Connection 'model.btc.stg_btc' was left open.
[0m17:57:53.224148 [debug] [MainThread]: On model.btc.stg_btc: Close
[0m17:57:53.931752 [info ] [MainThread]: 
[0m17:57:53.932982 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m17:57:53.934387 [debug] [MainThread]: Command end result
[0m17:57:53.958497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:57:53.960234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:57:53.964905 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m17:57:53.965186 [info ] [MainThread]: 
[0m17:57:53.965518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:53.965771 [info ] [MainThread]: 
[0m17:57:53.966029 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:57:53.966440 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:57:53.968898 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8409948, "process_in_blocks": "0", "process_kernel_time": 0.219331, "process_mem_max_rss": "164102144", "process_out_blocks": "0", "process_user_time": 1.400322}
[0m17:57:53.969298 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:53.969233 after 2.84 seconds
[0m17:57:53.969567 [debug] [MainThread]: Flushing usage events
[0m17:58:20.462436 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:58:20.474327 | 3b532dc5-d8db-43ca-9913-eec018a0a80f ==============================
[0m17:58:20.474327 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:58:20.474847 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/Users/mac/.dbt', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'version_check': 'True', 'empty': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m17:58:20.688226 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:58:20.759330 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:58:20.850285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:20.850557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:20.853413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m17:58:20.916276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:58:20.917339 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:58:20.929763 [info ] [MainThread]: Found 1 model, 2 data tests, 1 source, 479 macros
[0m17:58:20.930649 [info ] [MainThread]: 
[0m17:58:20.930853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:20.931016 [info ] [MainThread]: 
[0m17:58:20.931279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:58:20.931725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc_btc_schema'
[0m17:58:20.965108 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m17:58:20.965346 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m17:58:20.965510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:24.153829 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 3.188 seconds
[0m17:58:24.162328 [debug] [Thread-1 (]: Began running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:58:24.163011 [info ] [Thread-1 (]: 1 of 2 START test not_null_stg_btc_HASHKEY ..................................... [RUN]
[0m17:58:24.163582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now test.btc.not_null_stg_btc_HASHKEY.f1464799d5)
[0m17:58:24.164008 [debug] [Thread-1 (]: Began compiling node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:58:24.182386 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m17:58:24.183574 [debug] [Thread-1 (]: Began executing node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:58:24.203032 [debug] [Thread-1 (]: Writing runtime sql for node "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m17:58:24.204354 [debug] [Thread-1 (]: Using snowflake connection "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m17:58:24.204662 [debug] [Thread-1 (]: On test.btc.not_null_stg_btc_HASHKEY.f1464799d5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select HASHKEY
from btc.btc_schema.stg_btc
where HASHKEY is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"} */
[0m17:58:24.805980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m17:58:24.819980 [info ] [Thread-1 (]: 1 of 2 PASS not_null_stg_btc_HASHKEY ........................................... [[32mPASS[0m in 0.66s]
[0m17:58:24.820811 [debug] [Thread-1 (]: Finished running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:58:24.821309 [debug] [Thread-1 (]: Began running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:58:24.821894 [info ] [Thread-1 (]: 2 of 2 START test unique_stg_btc_HASHKEY ....................................... [RUN]
[0m17:58:24.822541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.btc.not_null_stg_btc_HASHKEY.f1464799d5, now test.btc.unique_stg_btc_HASHKEY.3bc82edb0f)
[0m17:58:24.822998 [debug] [Thread-1 (]: Began compiling node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:58:24.831276 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m17:58:24.832059 [debug] [Thread-1 (]: Began executing node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:58:24.834119 [debug] [Thread-1 (]: Writing runtime sql for node "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m17:58:24.834769 [debug] [Thread-1 (]: Using snowflake connection "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m17:58:24.834969 [debug] [Thread-1 (]: On test.btc.unique_stg_btc_HASHKEY.3bc82edb0f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    HASHKEY as unique_field,
    count(*) as n_records

from btc.btc_schema.stg_btc
where HASHKEY is not null
group by HASHKEY
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"} */
[0m17:58:25.337841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m17:58:25.342216 [info ] [Thread-1 (]: 2 of 2 PASS unique_stg_btc_HASHKEY ............................................. [[32mPASS[0m in 0.52s]
[0m17:58:25.343692 [debug] [Thread-1 (]: Finished running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:58:25.345754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:25.346249 [debug] [MainThread]: Connection 'test.btc.unique_stg_btc_HASHKEY.3bc82edb0f' was left open.
[0m17:58:25.346723 [debug] [MainThread]: On test.btc.unique_stg_btc_HASHKEY.3bc82edb0f: Close
[0m17:58:25.441219 [info ] [MainThread]: 
[0m17:58:25.442539 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m17:58:25.443995 [debug] [MainThread]: Command end result
[0m17:58:25.468241 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:58:25.470118 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:58:25.475562 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m17:58:25.475847 [info ] [MainThread]: 
[0m17:58:25.476171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:25.476442 [info ] [MainThread]: 
[0m17:58:25.476714 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:58:25.479183 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.0426893, "process_in_blocks": "0", "process_kernel_time": 0.220773, "process_mem_max_rss": "166952960", "process_out_blocks": "0", "process_user_time": 1.40324}
[0m17:58:25.479608 [debug] [MainThread]: Command `dbt test` succeeded at 17:58:25.479538 after 5.04 seconds
[0m17:58:25.479886 [debug] [MainThread]: Flushing usage events
[0m10:06:18.775615 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:06:18.787499 | dc468ef5-e5d1-4892-b54a-f85bc5f2516e ==============================
[0m10:06:18.787499 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:06:18.788130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'profiles_dir': '/Users/mac/.dbt', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'invocation_command': 'dbt ', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'partial_parse': 'True'}
[0m10:06:18.857784 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:06:18.858523 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:06:18.864984 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.119180545, "process_in_blocks": "0", "process_kernel_time": 0.102628, "process_mem_max_rss": "111640576", "process_out_blocks": "0", "process_user_time": 0.796534}
[0m10:06:18.865288 [debug] [MainThread]: Command `cli deps` succeeded at 10:06:18.865229 after 0.12 seconds
[0m10:06:18.865483 [debug] [MainThread]: Flushing usage events
[0m10:07:23.897017 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:07:23.908488 | c07dbcb1-1c5a-4a32-8844-cf8602865b62 ==============================
[0m10:07:23.908488 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:07:23.909031 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'version_check': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt ', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None'}
[0m10:07:23.974457 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:07:23.975022 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:07:23.976425 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.106870085, "process_in_blocks": "0", "process_kernel_time": 0.096871, "process_mem_max_rss": "111280128", "process_out_blocks": "0", "process_user_time": 0.78707}
[0m10:07:23.976710 [debug] [MainThread]: Command `cli deps` succeeded at 10:07:23.976654 after 0.11 seconds
[0m10:07:23.976882 [debug] [MainThread]: Flushing usage events
[0m10:10:51.861410 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:10:51.873177 | feb5b5fa-1560-424d-bddb-ba6d1bbfdcf3 ==============================
[0m10:10:51.873177 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:10:51.873844 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'target_path': 'None', 'invocation_command': 'dbt ', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m10:10:51.940874 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:10:51.941506 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:10:51.942924 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11068575, "process_in_blocks": "0", "process_kernel_time": 0.088938, "process_mem_max_rss": "111656960", "process_out_blocks": "0", "process_user_time": 0.782831}
[0m10:10:51.943224 [debug] [MainThread]: Command `cli deps` succeeded at 10:10:51.943167 after 0.11 seconds
[0m10:10:51.943401 [debug] [MainThread]: Flushing usage events
[0m10:14:14.138472 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:14:14.150565 | e5d769cc-f903-45ff-9af1-0a040ac9d5aa ==============================
[0m10:14:14.150565 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:14:14.151241 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -m stg_btc', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'warn_error': 'None', 'quiet': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'cache_selected_only': 'False', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m10:14:14.151591 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:14:14.392583 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m10:14:14.465451 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m10:14:14.564041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:14.564348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:14.568041 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m10:14:14.638133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m10:14:14.639267 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m10:14:14.646848 [info ] [MainThread]: Found 1 model, 2 data tests, 1 source, 479 macros
[0m10:14:14.647651 [info ] [MainThread]: 
[0m10:14:14.647921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:14:14.648118 [info ] [MainThread]: 
[0m10:14:14.648398 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:14:14.648891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m10:14:14.681635 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m10:14:14.681923 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m10:14:14.682107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:15.918761 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.237 seconds
[0m10:14:15.922024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m10:14:15.935767 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m10:14:15.936149 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m10:14:16.083422 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.147 seconds
[0m10:14:16.091871 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m10:14:16.092652 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc ................................. [RUN]
[0m10:14:16.093506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m10:14:16.093966 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m10:14:16.102226 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m10:14:16.103334 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m10:14:16.130901 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m10:14:16.131825 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m10:14:16.132100 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace   view btc.btc_schema.stg_btc
  
  
  
  
  as (
    select *
from btc.btc_schema.btc
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m10:14:16.373415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m10:14:16.395863 [info ] [Thread-1 (]: 1 of 1 OK created sql view model btc_schema.stg_btc ............................ [[32mSUCCESS 1[0m in 0.30s]
[0m10:14:16.396446 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m10:14:16.397364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:16.397630 [debug] [MainThread]: Connection 'model.btc.stg_btc' was left open.
[0m10:14:16.397849 [debug] [MainThread]: On model.btc.stg_btc: Close
[0m10:14:16.501985 [info ] [MainThread]: 
[0m10:14:16.502589 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m10:14:16.503409 [debug] [MainThread]: Command end result
[0m10:14:16.520704 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m10:14:16.522551 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m10:14:16.527296 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m10:14:16.527589 [info ] [MainThread]: 
[0m10:14:16.527901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:14:16.528135 [info ] [MainThread]: 
[0m10:14:16.528364 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:14:16.528746 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:14:16.530761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4217587, "process_in_blocks": "0", "process_kernel_time": 0.219837, "process_mem_max_rss": "166363136", "process_out_blocks": "0", "process_user_time": 1.425275}
[0m10:14:16.531097 [debug] [MainThread]: Command `dbt run` succeeded at 10:14:16.531045 after 2.42 seconds
[0m10:14:16.531340 [debug] [MainThread]: Flushing usage events
[0m11:55:40.742545 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 11:55:40.756097 | 7beb319b-734c-413a-bd77-d7bb289739b3 ==============================
[0m11:55:40.756097 [info ] [MainThread]: Running with dbt=1.10.11
[0m11:55:40.756792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'target_path': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_format': 'default', 'introspect': 'True', 'partial_parse': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt ', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False'}
[0m11:55:40.837479 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:55:40.838174 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:55:40.842654 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13113584, "process_in_blocks": "0", "process_kernel_time": 0.114531, "process_mem_max_rss": "111083520", "process_out_blocks": "0", "process_user_time": 0.867674}
[0m11:55:40.843072 [debug] [MainThread]: Command `cli deps` succeeded at 11:55:40.843001 after 0.13 seconds
[0m11:55:40.843307 [debug] [MainThread]: Flushing usage events
[0m12:33:11.303572 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:33:11.317755 | 035849e9-a621-4572-a610-bdabb8ba58cb ==============================
[0m12:33:11.317755 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:33:11.318305 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/mac/.dbt', 'empty': 'False', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run -m stg_btc'}
[0m12:33:11.318581 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:33:11.579788 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:33:11.649247 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:33:11.736351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:11.736760 [debug] [MainThread]: Partial parsing: updated file: btc://models/stg_btc.sql
[0m12:33:11.826293 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_btc (models/stg_btc.sql)
  expected token 'end of print statement', got 'is_incremental'
    line 11
      {{if is_incremental()}}
[0m12:33:11.826688 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:33:11.829305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.55177236, "process_in_blocks": "0", "process_kernel_time": 0.161357, "process_mem_max_rss": "140296192", "process_out_blocks": "0", "process_user_time": 1.081891}
[0m12:33:11.829658 [debug] [MainThread]: Command `dbt run` failed at 12:33:11.829613 after 0.55 seconds
[0m12:33:11.829858 [debug] [MainThread]: Flushing usage events
[0m12:33:54.160360 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:33:54.171266 | f0fc4715-4245-41fe-a328-a9e253690545 ==============================
[0m12:33:54.171266 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:33:54.171785 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'target_path': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'profiles_dir': '/Users/mac/.dbt', 'invocation_command': 'dbt run -m stg_btc', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'version_check': 'True'}
[0m12:33:54.172051 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:33:54.390312 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:33:54.461011 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:33:54.550993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:54.551438 [debug] [MainThread]: Partial parsing: updated file: btc://models/stg_btc.sql
[0m12:33:54.643406 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_btc (models/stg_btc.sql)
  expected token 'end of print statement', got 'is_incremental'
    line 11
      {{if is_incremental()}}
[0m12:33:54.643819 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:33:54.645223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.51168406, "process_in_blocks": "0", "process_kernel_time": 0.155112, "process_mem_max_rss": "139755520", "process_out_blocks": "0", "process_user_time": 1.0887}
[0m12:33:54.645548 [debug] [MainThread]: Command `dbt run` failed at 12:33:54.645502 after 0.51 seconds
[0m12:33:54.645744 [debug] [MainThread]: Flushing usage events
[0m12:37:01.725576 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:37:01.736811 | 93013d76-1701-4068-9e1d-b120700a7019 ==============================
[0m12:37:01.736811 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:37:01.737360 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'empty': 'False', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '/Users/mac/.dbt', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_btc', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m12:37:01.737615 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:37:01.951518 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:37:02.022120 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:37:02.114296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:02.114585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:02.117505 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:37:02.181518 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:37:02.182817 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:37:02.193554 [info ] [MainThread]: Found 1 model, 2 data tests, 1 source, 479 macros
[0m12:37:02.194320 [info ] [MainThread]: 
[0m12:37:02.194539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:02.194759 [info ] [MainThread]: 
[0m12:37:02.195038 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:37:02.195477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:37:02.227751 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:37:02.228047 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:37:02.228409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:05.575648 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.347 seconds
[0m12:37:05.579978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:37:05.595718 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:37:05.596125 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:37:05.703717 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.107 seconds
[0m12:37:05.709959 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m12:37:05.710682 [info ] [Thread-1 (]: 1 of 1 START sql incremental model btc_schema.stg_btc .......................... [RUN]
[0m12:37:05.711535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m12:37:05.712025 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m12:37:05.724214 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m12:37:05.724969 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m12:37:05.762709 [debug] [Thread-1 (]: Dropping relation btc.btc_schema.stg_btc because it is a view and this model is a table.
[0m12:37:05.766615 [debug] [Thread-1 (]: Applying DROP to: "BTC"."BTC_SCHEMA"."STG_BTC"
[0m12:37:05.770485 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m12:37:05.770746 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists "BTC"."BTC_SCHEMA"."STG_BTC" cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m12:37:05.983204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m12:37:06.006727 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m12:37:06.008439 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m12:37:06.008801 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace transient table btc.btc_schema.stg_btc
    
    
    
    as (

select * from btc.btc_schema.btc


    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m12:37:08.183018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.173 seconds
[0m12:37:08.193064 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc__dbt_tmp
[0m12:37:08.194359 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m12:37:08.194813 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists btc.btc_schema.stg_btc__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m12:37:08.283660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m12:37:08.312482 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model btc_schema.stg_btc ..................... [[32mSUCCESS 1[0m in 2.60s]
[0m12:37:08.313119 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m12:37:08.314138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:08.314486 [debug] [MainThread]: Connection 'model.btc.stg_btc' was left open.
[0m12:37:08.314775 [debug] [MainThread]: On model.btc.stg_btc: Close
[0m12:37:08.395740 [info ] [MainThread]: 
[0m12:37:08.396372 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m12:37:08.397066 [debug] [MainThread]: Command end result
[0m12:37:08.414024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:37:08.415691 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:37:08.420761 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:37:08.421049 [info ] [MainThread]: 
[0m12:37:08.422546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:08.423189 [info ] [MainThread]: 
[0m12:37:08.423513 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:37:08.423992 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:37:08.426157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7266784, "process_in_blocks": "0", "process_kernel_time": 0.235501, "process_mem_max_rss": "165707776", "process_out_blocks": "0", "process_user_time": 1.480817}
[0m12:37:08.426498 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:08.426443 after 6.73 seconds
[0m12:37:08.426768 [debug] [MainThread]: Flushing usage events
[0m12:38:44.578361 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:38:44.589598 | f5e252bc-12c6-4f6d-a3e8-ae1f1e3a9b8a ==============================
[0m12:38:44.589598 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:38:44.590155 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'write_json': 'True', 'invocation_command': 'dbt run -m stg_btc --full-refresh', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/Users/mac/.dbt', 'log_cache_events': 'False'}
[0m12:38:44.590415 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:38:44.808053 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:38:44.875777 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:38:44.964151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:44.964436 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:44.967307 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:38:45.032702 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:38:45.033864 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:38:45.040877 [info ] [MainThread]: Found 1 model, 2 data tests, 1 source, 479 macros
[0m12:38:45.041651 [info ] [MainThread]: 
[0m12:38:45.041856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:38:45.042021 [info ] [MainThread]: 
[0m12:38:45.042335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:38:45.042811 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:38:45.081798 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:38:45.082694 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:38:45.083047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:48.234338 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.151 seconds
[0m12:38:48.238056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:38:48.254621 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:38:48.255130 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:38:48.343316 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.088 seconds
[0m12:38:48.350874 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m12:38:48.351706 [info ] [Thread-1 (]: 1 of 1 START sql incremental model btc_schema.stg_btc .......................... [RUN]
[0m12:38:48.352564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m12:38:48.353027 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m12:38:48.367915 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m12:38:48.368742 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m12:38:48.414764 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m12:38:48.415471 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m12:38:48.415713 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace transient table btc.btc_schema.stg_btc
    
    
    
    as (

select * from btc.btc_schema.btc


    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m12:38:50.302213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.886 seconds
[0m12:38:50.315104 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc__dbt_tmp
[0m12:38:50.322653 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m12:38:50.323125 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists btc.btc_schema.stg_btc__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m12:38:50.402448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m12:38:50.427863 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model btc_schema.stg_btc ..................... [[32mSUCCESS 1[0m in 2.07s]
[0m12:38:50.428461 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m12:38:50.429591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:50.429898 [debug] [MainThread]: Connection 'model.btc.stg_btc' was left open.
[0m12:38:50.430151 [debug] [MainThread]: On model.btc.stg_btc: Close
[0m12:38:50.530810 [info ] [MainThread]: 
[0m12:38:50.531456 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m12:38:50.532149 [debug] [MainThread]: Command end result
[0m12:38:50.549360 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:38:50.551398 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:38:50.556030 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:38:50.556295 [info ] [MainThread]: 
[0m12:38:50.556609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:50.556863 [info ] [MainThread]: 
[0m12:38:50.557098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:38:50.557471 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:38:50.559378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.006976, "process_in_blocks": "0", "process_kernel_time": 0.220922, "process_mem_max_rss": "165937152", "process_out_blocks": "0", "process_user_time": 1.460698}
[0m12:38:50.559713 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:50.559660 after 6.01 seconds
[0m12:38:50.559973 [debug] [MainThread]: Flushing usage events
[0m12:46:26.168685 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:46:26.180210 | 6a74a1a6-4077-41fa-97c5-ce9c521670c6 ==============================
[0m12:46:26.180210 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:46:26.180771 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True', 'invocation_command': 'dbt run -m stg_btc_outputs', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'False'}
[0m12:46:26.181043 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:46:26.395692 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:46:26.463762 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:46:26.555036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:26.555337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:26.558285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:46:26.623688 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:46:26.624884 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:46:26.633014 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:46:26.633819 [info ] [MainThread]: 
[0m12:46:26.634027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:26.634191 [info ] [MainThread]: 
[0m12:46:26.634462 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:26.634907 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:46:26.667525 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:46:26.667818 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:46:26.668001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:29.905391 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.237 seconds
[0m12:46:29.914775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:46:29.929007 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:46:29.929366 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:46:30.032671 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.103 seconds
[0m12:46:30.040004 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:46:30.040787 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:46:30.041445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:46:30.041870 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:46:30.050635 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:46:30.051776 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:46:30.077821 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:46:30.078863 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:46:30.079152 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select t.hashkey, t.block_number, t.block_timestamp, t.is_coinbase
from btc.btc_schema.stg_btc as t
lateral flattern(input => outputs) as o
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:46:30.270827 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1c06-0004-e260-0000-0000f195a16d
[0m12:46:30.271635 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 0 unexpected 'lateral'.
syntax error line 9 at position 35 unexpected 'as'.
[0m12:46:30.277251 [debug] [Thread-1 (]: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 0 unexpected 'lateral'.
  syntax error line 9 at position 35 unexpected 'as'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:46:30.279655 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model btc_schema.stg_btc_outputs ................ [[31mERROR[0m in 0.24s]
[0m12:46:30.280511 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:46:30.281200 [debug] [Thread-4 (]: Marking all children of 'model.btc.stg_btc_outputs' to be skipped because of status 'error'.  Reason: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 0 unexpected 'lateral'.
  syntax error line 9 at position 35 unexpected 'as'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql.
[0m12:46:30.283081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:30.283422 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:46:30.283732 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:46:30.397297 [info ] [MainThread]: 
[0m12:46:30.398415 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m12:46:30.399817 [debug] [MainThread]: Command end result
[0m12:46:30.426951 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:46:30.428790 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:46:30.433902 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:46:30.434200 [info ] [MainThread]: 
[0m12:46:30.434556 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:46:30.434826 [info ] [MainThread]: 
[0m12:46:30.435145 [error] [MainThread]: [31mFailure in model stg_btc_outputs (models/stg_btc_outputs.sql)[0m
[0m12:46:30.435447 [error] [MainThread]:   Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 0 unexpected 'lateral'.
  syntax error line 9 at position 35 unexpected 'as'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:46:30.435682 [info ] [MainThread]: 
[0m12:46:30.435952 [info ] [MainThread]:   compiled code at target/compiled/btc/models/stg_btc_outputs.sql
[0m12:46:30.436184 [info ] [MainThread]: 
[0m12:46:30.436456 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:46:30.436879 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:46:30.438998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.296743, "process_in_blocks": "0", "process_kernel_time": 0.228536, "process_mem_max_rss": "165478400", "process_out_blocks": "0", "process_user_time": 1.424437}
[0m12:46:30.439358 [debug] [MainThread]: Command `dbt run` failed at 12:46:30.439295 after 4.30 seconds
[0m12:46:30.439649 [debug] [MainThread]: Flushing usage events
[0m12:47:40.923637 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:47:40.934645 | 36da8ff4-9dcc-4399-b74a-5b0fb4fb9875 ==============================
[0m12:47:40.934645 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:47:40.935163 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/mac/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt run -m stg_btc_outputs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'use_colors': 'True'}
[0m12:47:40.935429 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:47:41.151343 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:47:41.223597 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:47:41.311779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:41.312073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:41.314953 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:47:41.378427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:47:41.379584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:47:41.386332 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:47:41.387070 [info ] [MainThread]: 
[0m12:47:41.387281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:41.387442 [info ] [MainThread]: 
[0m12:47:41.387688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:41.388094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:47:41.417042 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:47:41.417279 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:47:41.417454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:44.572268 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.155 seconds
[0m12:47:44.580697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:47:44.595031 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:47:44.595409 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:47:44.761284 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.165 seconds
[0m12:47:44.769391 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:47:44.770186 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:47:44.770728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:47:44.771170 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:47:44.780418 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:47:44.781612 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:47:44.807457 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:47:44.808468 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:47:44.808770 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select 
t.hashkey, 
t.block_number, 
t.block_timestamp, 
t.is_coinbase
from btc.btc_schema.stg_btc t

lateral flattern(input => outputs) o
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:47:44.921629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1c07-0004-e29a-0000-0000f1959fad
[0m12:47:44.922162 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'lateral'.
syntax error line 14 at position 35 unexpected 'o'.
[0m12:47:44.926347 [debug] [Thread-1 (]: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'lateral'.
  syntax error line 14 at position 35 unexpected 'o'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:47:44.928515 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model btc_schema.stg_btc_outputs ................ [[31mERROR[0m in 0.16s]
[0m12:47:44.929112 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:47:44.929582 [debug] [Thread-4 (]: Marking all children of 'model.btc.stg_btc_outputs' to be skipped because of status 'error'.  Reason: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'lateral'.
  syntax error line 14 at position 35 unexpected 'o'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql.
[0m12:47:44.931095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:44.931379 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:47:44.931646 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:47:45.019460 [info ] [MainThread]: 
[0m12:47:45.020076 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m12:47:45.020735 [debug] [MainThread]: Command end result
[0m12:47:45.045900 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:47:45.050342 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:47:45.062093 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:47:45.063095 [info ] [MainThread]: 
[0m12:47:45.065219 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:47:45.065850 [info ] [MainThread]: 
[0m12:47:45.066152 [error] [MainThread]: [31mFailure in model stg_btc_outputs (models/stg_btc_outputs.sql)[0m
[0m12:47:45.067098 [error] [MainThread]:   Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'lateral'.
  syntax error line 14 at position 35 unexpected 'o'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:47:45.067869 [info ] [MainThread]: 
[0m12:47:45.068207 [info ] [MainThread]:   compiled code at target/compiled/btc/models/stg_btc_outputs.sql
[0m12:47:45.068404 [info ] [MainThread]: 
[0m12:47:45.068607 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:47:45.069008 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:47:45.071082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1736546, "process_in_blocks": "0", "process_kernel_time": 0.227064, "process_mem_max_rss": "165658624", "process_out_blocks": "0", "process_user_time": 1.39769}
[0m12:47:45.071447 [debug] [MainThread]: Command `dbt run` failed at 12:47:45.071397 after 4.17 seconds
[0m12:47:45.071727 [debug] [MainThread]: Flushing usage events
[0m12:48:29.440735 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:48:29.451942 | 0b871783-c50a-4e3f-a20e-00b89f79def8 ==============================
[0m12:48:29.451942 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:48:29.452476 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'invocation_command': 'dbt run -m stg_btc_outputs', 'printer_width': '80', 'profiles_dir': '/Users/mac/.dbt', 'target_path': 'None', 'fail_fast': 'False', 'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'empty': 'False'}
[0m12:48:29.452751 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:48:29.667172 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:48:29.736351 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:48:29.826200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:29.826471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:29.829443 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:48:29.893278 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:48:29.894405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:48:29.901756 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:48:29.902527 [info ] [MainThread]: 
[0m12:48:29.902738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:29.902899 [info ] [MainThread]: 
[0m12:48:29.903153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:29.903571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:48:29.933274 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:48:29.933542 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:48:29.933710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:31.033216 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.099 seconds
[0m12:48:31.042715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:48:31.057187 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:48:31.057638 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:48:31.167195 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.109 seconds
[0m12:48:31.170359 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:48:31.170735 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:48:31.171075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:48:31.171323 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:48:31.176548 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:48:31.177140 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:48:31.198037 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:48:31.198864 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:48:31.199105 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select 
t.hashkey, 
t.block_number, 
t.block_timestamp, 
t.is_coinbase,
o.value as output_value,
from btc.btc_schema.stg_btc t

lateral flattern(input => outputs) o
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:48:31.269486 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1c08-0004-e262-0000-0000f1958359
[0m12:48:31.269933 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 0 unexpected 'lateral'.
syntax error line 15 at position 35 unexpected 'o'.
[0m12:48:31.273240 [debug] [Thread-1 (]: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'lateral'.
  syntax error line 15 at position 35 unexpected 'o'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:48:31.274808 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model btc_schema.stg_btc_outputs ................ [[31mERROR[0m in 0.10s]
[0m12:48:31.275267 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:48:31.275631 [debug] [Thread-4 (]: Marking all children of 'model.btc.stg_btc_outputs' to be skipped because of status 'error'.  Reason: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'lateral'.
  syntax error line 15 at position 35 unexpected 'o'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql.
[0m12:48:31.276945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:31.277219 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:48:31.277455 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:48:31.363757 [info ] [MainThread]: 
[0m12:48:31.364250 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m12:48:31.364889 [debug] [MainThread]: Command end result
[0m12:48:31.382265 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:48:31.383678 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:48:31.388034 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:48:31.388282 [info ] [MainThread]: 
[0m12:48:31.388567 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:48:31.388787 [info ] [MainThread]: 
[0m12:48:31.389051 [error] [MainThread]: [31mFailure in model stg_btc_outputs (models/stg_btc_outputs.sql)[0m
[0m12:48:31.389301 [error] [MainThread]:   Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'lateral'.
  syntax error line 15 at position 35 unexpected 'o'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:48:31.389501 [info ] [MainThread]: 
[0m12:48:31.389729 [info ] [MainThread]:   compiled code at target/compiled/btc/models/stg_btc_outputs.sql
[0m12:48:31.389921 [info ] [MainThread]: 
[0m12:48:31.390136 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:48:31.390502 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:48:31.392338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9778326, "process_in_blocks": "0", "process_kernel_time": 0.211725, "process_mem_max_rss": "165822464", "process_out_blocks": "0", "process_user_time": 1.337141}
[0m12:48:31.392670 [debug] [MainThread]: Command `dbt run` failed at 12:48:31.392617 after 1.98 seconds
[0m12:48:31.392959 [debug] [MainThread]: Flushing usage events
[0m12:48:48.829326 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:48:48.840222 | 8f890118-4293-423f-9692-c010b204aa29 ==============================
[0m12:48:48.840222 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:48:48.840760 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mac/.dbt', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'empty': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m stg_btc_outputs', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None'}
[0m12:48:48.841035 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:48:49.054144 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:48:49.121799 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:48:49.212713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:49.213027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:49.216079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:48:49.279882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:48:49.280953 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:48:49.287813 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:48:49.288566 [info ] [MainThread]: 
[0m12:48:49.288782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:49.288947 [info ] [MainThread]: 
[0m12:48:49.289199 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:49.289619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:48:49.317855 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:48:49.318084 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:48:49.318253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:52.674123 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.356 seconds
[0m12:48:52.679049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:48:52.689051 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:48:52.689363 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:48:52.796716 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.107 seconds
[0m12:48:52.801213 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:48:52.801801 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:48:52.802288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:48:52.802634 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:48:52.809372 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:48:52.810165 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:48:52.834258 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:48:52.835271 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:48:52.835549 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select 
t.hashkey, 
t.block_number, 
t.block_timestamp, 
t.is_coinbase,
o.value as output_value,
from btc.btc_schema.stg_btc t

lateral flattern(input => outputs) o
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:48:52.923355 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1c08-0004-e2d2-0000-0000f195c129
[0m12:48:52.923804 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 0 unexpected 'lateral'.
syntax error line 15 at position 35 unexpected 'o'.
[0m12:48:52.927287 [debug] [Thread-1 (]: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'lateral'.
  syntax error line 15 at position 35 unexpected 'o'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:48:52.928998 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model btc_schema.stg_btc_outputs ................ [[31mERROR[0m in 0.13s]
[0m12:48:52.929557 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:48:52.930002 [debug] [Thread-4 (]: Marking all children of 'model.btc.stg_btc_outputs' to be skipped because of status 'error'.  Reason: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'lateral'.
  syntax error line 15 at position 35 unexpected 'o'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql.
[0m12:48:52.931295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:52.931547 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:48:52.931779 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:48:53.022675 [info ] [MainThread]: 
[0m12:48:53.023396 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m12:48:53.024274 [debug] [MainThread]: Command end result
[0m12:48:53.045024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:48:53.046739 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:48:53.051887 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:48:53.052182 [info ] [MainThread]: 
[0m12:48:53.052498 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:48:53.052752 [info ] [MainThread]: 
[0m12:48:53.053044 [error] [MainThread]: [31mFailure in model stg_btc_outputs (models/stg_btc_outputs.sql)[0m
[0m12:48:53.053314 [error] [MainThread]:   Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'lateral'.
  syntax error line 15 at position 35 unexpected 'o'.
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:48:53.053568 [info ] [MainThread]: 
[0m12:48:53.053879 [info ] [MainThread]:   compiled code at target/compiled/btc/models/stg_btc_outputs.sql
[0m12:48:53.054108 [info ] [MainThread]: 
[0m12:48:53.054350 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:48:53.054845 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:48:53.056789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.253547, "process_in_blocks": "0", "process_kernel_time": 0.212714, "process_mem_max_rss": "165036032", "process_out_blocks": "0", "process_user_time": 1.360483}
[0m12:48:53.057155 [debug] [MainThread]: Command `dbt run` failed at 12:48:53.057097 after 4.25 seconds
[0m12:48:53.057432 [debug] [MainThread]: Flushing usage events
[0m12:49:16.145967 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:49:16.156882 | b036a5e8-420c-4ad2-b65f-2e6fd75c2ee7 ==============================
[0m12:49:16.156882 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:49:16.157393 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'target_path': 'None', 'use_colors': 'True', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_btc_outputs', 'cache_selected_only': 'False', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None'}
[0m12:49:16.157657 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:49:16.370059 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:49:16.440115 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:49:16.529595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:16.529861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:16.532785 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:49:16.596307 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:49:16.597384 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:49:16.604144 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:49:16.604893 [info ] [MainThread]: 
[0m12:49:16.605116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:16.606198 [info ] [MainThread]: 
[0m12:49:16.606494 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:16.607114 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:49:16.636782 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:49:16.637040 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:49:16.637222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:19.707246 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.070 seconds
[0m12:49:19.716898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:49:19.731665 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:49:19.732040 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:49:19.808661 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.076 seconds
[0m12:49:19.813237 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:49:19.813777 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:49:19.814264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:49:19.814620 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:49:19.822182 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:49:19.823081 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:49:19.848119 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:49:19.849018 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:49:19.849317 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select 
t.hashkey, 
t.block_number, 
t.block_timestamp, 
t.is_coinbase,
o.value as output_value,
from btc.btc_schema.stg_btc t,

lateral flattern(input => outputs) o
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:49:19.970134 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1c09-0004-e2d2-0000-0000f195c12d
[0m12:49:19.970842 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002142 (42601): SQL compilation error:
Unknown table function FLATTERN
[0m12:49:19.974657 [debug] [Thread-1 (]: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  002142 (42601): SQL compilation error:
  Unknown table function FLATTERN
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:49:19.976468 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model btc_schema.stg_btc_outputs ................ [[31mERROR[0m in 0.16s]
[0m12:49:19.977042 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:49:19.977504 [debug] [Thread-4 (]: Marking all children of 'model.btc.stg_btc_outputs' to be skipped because of status 'error'.  Reason: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  002142 (42601): SQL compilation error:
  Unknown table function FLATTERN
  compiled code at target/run/btc/models/stg_btc_outputs.sql.
[0m12:49:19.978941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:19.979270 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:49:19.979547 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:49:20.102052 [info ] [MainThread]: 
[0m12:49:20.102666 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m12:49:20.103320 [debug] [MainThread]: Command end result
[0m12:49:20.123729 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:49:20.125953 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:49:20.131024 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:49:20.131367 [info ] [MainThread]: 
[0m12:49:20.131701 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:49:20.131961 [info ] [MainThread]: 
[0m12:49:20.132259 [error] [MainThread]: [31mFailure in model stg_btc_outputs (models/stg_btc_outputs.sql)[0m
[0m12:49:20.132527 [error] [MainThread]:   Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  002142 (42601): SQL compilation error:
  Unknown table function FLATTERN
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:49:20.132739 [info ] [MainThread]: 
[0m12:49:20.132995 [info ] [MainThread]:   compiled code at target/compiled/btc/models/stg_btc_outputs.sql
[0m12:49:20.133215 [info ] [MainThread]: 
[0m12:49:20.133465 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:49:20.133890 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:49:20.136052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.016597, "process_in_blocks": "0", "process_kernel_time": 0.211773, "process_mem_max_rss": "166035456", "process_out_blocks": "0", "process_user_time": 1.373771}
[0m12:49:20.136603 [debug] [MainThread]: Command `dbt run` failed at 12:49:20.136485 after 4.02 seconds
[0m12:49:20.136960 [debug] [MainThread]: Flushing usage events
[0m12:50:02.184215 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:50:02.195291 | 24cd357a-034c-47b9-a772-a5ebbf03dcda ==============================
[0m12:50:02.195291 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:50:02.195820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run -m stg_btc_outputs', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'profiles_dir': '/Users/mac/.dbt'}
[0m12:50:02.196074 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:50:02.412874 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:50:02.482587 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:50:02.573014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:02.573289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:02.576272 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:50:02.642883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:50:02.643949 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:50:02.650879 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:50:02.651619 [info ] [MainThread]: 
[0m12:50:02.651827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:02.651991 [info ] [MainThread]: 
[0m12:50:02.652260 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:02.652678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:50:02.681533 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:50:02.681771 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:50:02.681938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:05.814175 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.132 seconds
[0m12:50:05.823624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:50:05.837829 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:50:05.838198 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:50:05.915822 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.077 seconds
[0m12:50:05.920816 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:50:05.921408 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:50:05.921943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:50:05.922278 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:50:05.929552 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:50:05.930523 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:50:05.953992 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:50:05.954895 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:50:05.955154 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select 
t.hashkey, 
t.block_number, 
t.block_timestamp, 
t.is_coinbase,
o.value as output_value

from btc.btc_schema.stg_btc t,

lateral flattern(input => outputs) o
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:50:06.090422 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1c0a-0004-e260-0000-0000f195a17d
[0m12:50:06.090920 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002142 (42601): SQL compilation error:
Unknown table function FLATTERN
[0m12:50:06.094230 [debug] [Thread-1 (]: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  002142 (42601): SQL compilation error:
  Unknown table function FLATTERN
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:50:06.096211 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model btc_schema.stg_btc_outputs ................ [[31mERROR[0m in 0.17s]
[0m12:50:06.096790 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:50:06.097201 [debug] [Thread-4 (]: Marking all children of 'model.btc.stg_btc_outputs' to be skipped because of status 'error'.  Reason: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  002142 (42601): SQL compilation error:
  Unknown table function FLATTERN
  compiled code at target/run/btc/models/stg_btc_outputs.sql.
[0m12:50:06.098634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:06.098993 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:50:06.099270 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:50:06.196553 [info ] [MainThread]: 
[0m12:50:06.197021 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m12:50:06.197567 [debug] [MainThread]: Command end result
[0m12:50:06.213725 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:50:06.215359 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:50:06.219309 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:50:06.219529 [info ] [MainThread]: 
[0m12:50:06.219787 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:50:06.219995 [info ] [MainThread]: 
[0m12:50:06.220240 [error] [MainThread]: [31mFailure in model stg_btc_outputs (models/stg_btc_outputs.sql)[0m
[0m12:50:06.220464 [error] [MainThread]:   Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  002142 (42601): SQL compilation error:
  Unknown table function FLATTERN
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:50:06.220647 [info ] [MainThread]: 
[0m12:50:06.220854 [info ] [MainThread]:   compiled code at target/compiled/btc/models/stg_btc_outputs.sql
[0m12:50:06.221024 [info ] [MainThread]: 
[0m12:50:06.221223 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:50:06.221565 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:50:06.223483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.0658684, "process_in_blocks": "0", "process_kernel_time": 0.221577, "process_mem_max_rss": "165593088", "process_out_blocks": "0", "process_user_time": 1.377231}
[0m12:50:06.223836 [debug] [MainThread]: Command `dbt run` failed at 12:50:06.223780 after 4.07 seconds
[0m12:50:06.224089 [debug] [MainThread]: Flushing usage events
[0m12:50:23.133566 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:50:23.145254 | 09f5556e-927a-452a-a2e1-829bf5af7402 ==============================
[0m12:50:23.145254 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:50:23.145793 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'invocation_command': 'dbt run -m stg_btc_outputs', 'static_parser': 'True', 'warn_error': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'target_path': 'None'}
[0m12:50:23.146076 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:50:23.360160 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:50:23.429152 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:50:23.518552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:23.518861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:23.521854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:50:23.586289 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:50:23.587411 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:50:23.594508 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:50:23.595251 [info ] [MainThread]: 
[0m12:50:23.595465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:23.595636 [info ] [MainThread]: 
[0m12:50:23.595896 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:23.596325 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:50:23.625875 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:50:23.626136 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:50:23.626308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:26.663177 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.037 seconds
[0m12:50:26.672861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:50:26.687302 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:50:26.687693 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:50:26.829077 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.141 seconds
[0m12:50:26.837012 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:50:26.837899 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:50:26.838482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:50:26.838940 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:50:26.847927 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:50:26.849093 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:50:26.875859 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:50:26.876801 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:50:26.877084 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select 
t.hashkey, 
t.block_number, 
t.block_timestamp, 
t.is_coinbase,
o.value as output_value

from btc.btc_schema.stg_btc t,

lateral flatten(input => outputs) o
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:50:27.081452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m12:50:27.109443 [info ] [Thread-1 (]: 1 of 1 OK created sql view model btc_schema.stg_btc_outputs .................... [[32mSUCCESS 1[0m in 0.27s]
[0m12:50:27.110143 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:50:27.111259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:27.111570 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:50:27.111850 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:50:27.198557 [info ] [MainThread]: 
[0m12:50:27.199146 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m12:50:27.199882 [debug] [MainThread]: Command end result
[0m12:50:27.220028 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:50:27.221541 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:50:27.225961 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:50:27.226307 [info ] [MainThread]: 
[0m12:50:27.226667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:27.226927 [info ] [MainThread]: 
[0m12:50:27.227174 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:50:27.227569 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:50:27.229550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1219997, "process_in_blocks": "0", "process_kernel_time": 0.212935, "process_mem_max_rss": "164970496", "process_out_blocks": "0", "process_user_time": 1.403816}
[0m12:50:27.229890 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:27.229834 after 4.12 seconds
[0m12:50:27.230143 [debug] [MainThread]: Flushing usage events
[0m12:53:35.695833 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:53:35.707016 | 0b5f3974-34fe-47e5-b8c3-e41628339278 ==============================
[0m12:53:35.707016 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:53:35.707530 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run -m stg_btc_outputs', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:53:35.707791 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:53:35.932771 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:53:36.003008 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:53:36.095622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:36.095900 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:36.099056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:53:36.163679 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:53:36.164803 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:53:36.171917 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:53:36.172658 [info ] [MainThread]: 
[0m12:53:36.172858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:36.173030 [info ] [MainThread]: 
[0m12:53:36.173301 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:53:36.173738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:53:36.205258 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:53:36.205523 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:53:36.205695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:39.304393 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.098 seconds
[0m12:53:39.312904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:53:39.326531 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:53:39.326922 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:53:39.451787 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.125 seconds
[0m12:53:39.455091 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:53:39.455499 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:53:39.455852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:53:39.456127 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:53:39.461438 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:53:39.462124 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:53:39.482732 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:53:39.483715 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:53:39.483980 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select 
t.hashkey, 
t.block_number, 
t.block_timestamp, 
t.is_coinbase,
o.value:value::FLOAT as output_value,
o.address:address::STRING as out_address

from btc.btc_schema.stg_btc t,

lateral flatten(input => outputs) o
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:53:39.660223 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1c0d-0004-e29a-0000-0000f195d039
[0m12:53:39.660796 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 0
invalid identifier 'O.ADDRESS'
[0m12:53:39.664410 [debug] [Thread-1 (]: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  000904 (42000): SQL compilation error: error line 13 at position 0
  invalid identifier 'O.ADDRESS'
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:53:39.666240 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model btc_schema.stg_btc_outputs ................ [[31mERROR[0m in 0.21s]
[0m12:53:39.666763 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:53:39.667173 [debug] [Thread-4 (]: Marking all children of 'model.btc.stg_btc_outputs' to be skipped because of status 'error'.  Reason: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  000904 (42000): SQL compilation error: error line 13 at position 0
  invalid identifier 'O.ADDRESS'
  compiled code at target/run/btc/models/stg_btc_outputs.sql.
[0m12:53:39.668840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:39.669168 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:53:39.669450 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:53:39.753833 [info ] [MainThread]: 
[0m12:53:39.754515 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m12:53:39.755263 [debug] [MainThread]: Command end result
[0m12:53:39.774828 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:53:39.776447 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:53:39.780936 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:53:39.781195 [info ] [MainThread]: 
[0m12:53:39.781485 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:53:39.781724 [info ] [MainThread]: 
[0m12:53:39.782018 [error] [MainThread]: [31mFailure in model stg_btc_outputs (models/stg_btc_outputs.sql)[0m
[0m12:53:39.782291 [error] [MainThread]:   Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  000904 (42000): SQL compilation error: error line 13 at position 0
  invalid identifier 'O.ADDRESS'
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:53:39.782503 [info ] [MainThread]: 
[0m12:53:39.782750 [info ] [MainThread]:   compiled code at target/compiled/btc/models/stg_btc_outputs.sql
[0m12:53:39.782956 [info ] [MainThread]: 
[0m12:53:39.783188 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:53:39.783589 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:53:39.785712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1164722, "process_in_blocks": "0", "process_kernel_time": 0.214085, "process_mem_max_rss": "165462016", "process_out_blocks": "0", "process_user_time": 1.384508}
[0m12:53:39.786072 [debug] [MainThread]: Command `dbt run` failed at 12:53:39.786008 after 4.12 seconds
[0m12:53:39.786351 [debug] [MainThread]: Flushing usage events
[0m12:55:43.415518 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:55:43.426338 | aa0007e7-2213-41c7-89ea-305210da6373 ==============================
[0m12:55:43.426338 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:55:43.426855 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'write_json': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/mac/.dbt', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m stg_btc_outputs', 'no_print': 'None', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False'}
[0m12:55:43.427114 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:55:43.642248 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:55:43.712351 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:55:43.801421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:43.801751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:43.804893 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:55:43.868694 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:55:43.869805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:55:43.876706 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:55:43.877460 [info ] [MainThread]: 
[0m12:55:43.877675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:55:43.877837 [info ] [MainThread]: 
[0m12:55:43.878096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:55:43.878521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:55:43.907059 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:55:43.907308 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:55:43.907482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:44.971306 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.064 seconds
[0m12:55:44.980174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:55:44.994628 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:55:44.995017 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:55:45.336238 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.341 seconds
[0m12:55:45.339443 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:55:45.339726 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:55:45.339989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:55:45.340176 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:55:45.344982 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:55:45.345651 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:55:45.367802 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:55:45.368721 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:55:45.368976 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select 
t.hashkey, 
t.block_number, 
t.block_timestamp, 
t.is_coinbase,
op.value:value::FLOAT as output_value,
op.address:address::STRING as out_address

from btc.btc_schema.stg_btc t,

lateral flatten(input => outputs) op
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:55:45.472226 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1c0f-0004-e29a-0000-0000f195d03d
[0m12:55:45.473105 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 0
invalid identifier 'OP.ADDRESS'
[0m12:55:45.476845 [debug] [Thread-1 (]: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  000904 (42000): SQL compilation error: error line 13 at position 0
  invalid identifier 'OP.ADDRESS'
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:55:45.478473 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model btc_schema.stg_btc_outputs ................ [[31mERROR[0m in 0.14s]
[0m12:55:45.478956 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:55:45.479490 [debug] [Thread-4 (]: Marking all children of 'model.btc.stg_btc_outputs' to be skipped because of status 'error'.  Reason: Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  000904 (42000): SQL compilation error: error line 13 at position 0
  invalid identifier 'OP.ADDRESS'
  compiled code at target/run/btc/models/stg_btc_outputs.sql.
[0m12:55:45.481242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:45.481579 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:55:45.481849 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:55:45.560379 [info ] [MainThread]: 
[0m12:55:45.560919 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m12:55:45.561580 [debug] [MainThread]: Command end result
[0m12:55:45.580999 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:55:45.583262 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:55:45.588153 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:55:45.588419 [info ] [MainThread]: 
[0m12:55:45.588696 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:55:45.588927 [info ] [MainThread]: 
[0m12:55:45.589182 [error] [MainThread]: [31mFailure in model stg_btc_outputs (models/stg_btc_outputs.sql)[0m
[0m12:55:45.589419 [error] [MainThread]:   Database Error in model stg_btc_outputs (models/stg_btc_outputs.sql)
  000904 (42000): SQL compilation error: error line 13 at position 0
  invalid identifier 'OP.ADDRESS'
  compiled code at target/run/btc/models/stg_btc_outputs.sql
[0m12:55:45.589612 [info ] [MainThread]: 
[0m12:55:45.589848 [info ] [MainThread]:   compiled code at target/compiled/btc/models/stg_btc_outputs.sql
[0m12:55:45.590037 [info ] [MainThread]: 
[0m12:55:45.590249 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:55:45.590601 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:55:45.592668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.203385, "process_in_blocks": "0", "process_kernel_time": 0.204273, "process_mem_max_rss": "164708352", "process_out_blocks": "0", "process_user_time": 1.353155}
[0m12:55:45.593047 [debug] [MainThread]: Command `dbt run` failed at 12:55:45.592983 after 2.20 seconds
[0m12:55:45.593333 [debug] [MainThread]: Flushing usage events
[0m12:57:08.533189 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:57:08.545384 | eee86515-50c9-418b-8473-ae921213050e ==============================
[0m12:57:08.545384 [info ] [MainThread]: Running with dbt=1.10.11
[0m12:57:08.545941 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'profiles_dir': '/Users/mac/.dbt', 'invocation_command': 'dbt run -m stg_btc_outputs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_format': 'default', 'fail_fast': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'write_json': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False', 'cache_selected_only': 'False'}
[0m12:57:08.546206 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m12:57:08.765871 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:57:08.833354 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m12:57:08.936064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:08.936413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:08.939523 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m12:57:09.004763 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:57:09.005907 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:57:09.013209 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 479 macros
[0m12:57:09.014018 [info ] [MainThread]: 
[0m12:57:09.014227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:09.014387 [info ] [MainThread]: 
[0m12:57:09.014650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:57:09.015107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m12:57:09.043892 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m12:57:09.044158 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m12:57:09.044333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:12.262453 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.218 seconds
[0m12:57:12.271115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m12:57:12.285377 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m12:57:12.285750 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m12:57:12.469579 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.183 seconds
[0m12:57:12.476483 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m12:57:12.477174 [info ] [Thread-1 (]: 1 of 1 START sql view model btc_schema.stg_btc_outputs ......................... [RUN]
[0m12:57:12.477728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m12:57:12.478153 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m12:57:12.486426 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m12:57:12.487390 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m12:57:12.513195 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m12:57:12.514198 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m12:57:12.514492 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace   view btc.btc_schema.stg_btc_outputs
  
  
  
  
  as (
    select
    t.hashkey,
    t.block_number,
    t.block_timestamp,
    t.is_coinbase,
    op.value:value::FLOAT as output_value,
    op.value:address::STRING as out_address 

from btc.btc_schema.stg_btc as t,
lateral flatten(input => t.outputs) as op
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m12:57:12.745436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m12:57:12.775120 [info ] [Thread-1 (]: 1 of 1 OK created sql view model btc_schema.stg_btc_outputs .................... [[32mSUCCESS 1[0m in 0.30s]
[0m12:57:12.775772 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m12:57:12.776748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:12.777093 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m12:57:12.777382 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m12:57:12.878382 [info ] [MainThread]: 
[0m12:57:12.879051 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m12:57:12.879890 [debug] [MainThread]: Command end result
[0m12:57:12.901558 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m12:57:12.903132 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m12:57:12.907689 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m12:57:12.907985 [info ] [MainThread]: 
[0m12:57:12.908307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:12.908557 [info ] [MainThread]: 
[0m12:57:12.908818 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:57:12.909214 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:57:12.911146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4044943, "process_in_blocks": "0", "process_kernel_time": 0.219548, "process_mem_max_rss": "166002688", "process_out_blocks": "0", "process_user_time": 1.44895}
[0m12:57:12.911487 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:12.911430 after 4.40 seconds
[0m12:57:12.911738 [debug] [MainThread]: Flushing usage events
[0m13:02:45.377455 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:02:45.390336 | 218e7eb5-874c-4f91-b596-ddc782de2511 ==============================
[0m13:02:45.390336 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:02:45.391001 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'printer_width': '80', 'introspect': 'True', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True', 'empty': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/mac/.dbt', 'partial_parse': 'True'}
[0m13:02:45.398530 [info ] [MainThread]: dbt version: 1.10.11
[0m13:02:45.398788 [info ] [MainThread]: python version: 3.12.0
[0m13:02:45.398972 [info ] [MainThread]: python path: /Users/mac/Desktop/DE2025/btc/venv/bin/python
[0m13:02:45.399138 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m13:02:45.538669 [info ] [MainThread]: Using profiles dir at /Users/mac/.dbt
[0m13:02:45.538966 [info ] [MainThread]: Using profiles.yml file at /Users/mac/.dbt/profiles.yml
[0m13:02:45.539132 [info ] [MainThread]: Using dbt_project.yml file at /Users/mac/Desktop/DE2025/btc/dbt_project.yml
[0m13:02:45.539385 [info ] [MainThread]: adapter type: snowflake
[0m13:02:45.539548 [info ] [MainThread]: adapter version: 1.10.2
[0m13:02:45.593324 [info ] [MainThread]: Configuration:
[0m13:02:45.593668 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:02:45.593855 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:02:45.594024 [info ] [MainThread]: Required dependencies:
[0m13:02:45.594251 [debug] [MainThread]: Executing "git --help"
[0m13:02:45.603182 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:02:45.603803 [debug] [MainThread]: STDERR: "b''"
[0m13:02:45.604073 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:02:45.604379 [info ] [MainThread]: Connection:
[0m13:02:45.604622 [info ] [MainThread]:   account: KTPPEJB-WW82576
[0m13:02:45.604813 [info ] [MainThread]:   user: carlos
[0m13:02:45.604986 [info ] [MainThread]:   database: btc
[0m13:02:45.605141 [info ] [MainThread]:   warehouse: btc
[0m13:02:45.605337 [info ] [MainThread]:   role: accountadmin
[0m13:02:45.605588 [info ] [MainThread]:   schema: btc_schema
[0m13:02:45.605937 [info ] [MainThread]:   authenticator: None
[0m13:02:45.606143 [info ] [MainThread]:   oauth_client_id: None
[0m13:02:45.606310 [info ] [MainThread]:   query_tag: None
[0m13:02:45.606472 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:02:45.606628 [info ] [MainThread]:   host: None
[0m13:02:45.606778 [info ] [MainThread]:   port: None
[0m13:02:45.606926 [info ] [MainThread]:   proxy_host: None
[0m13:02:45.607074 [info ] [MainThread]:   proxy_port: None
[0m13:02:45.607221 [info ] [MainThread]:   protocol: None
[0m13:02:45.607363 [info ] [MainThread]:   connect_retries: 1
[0m13:02:45.607508 [info ] [MainThread]:   connect_timeout: None
[0m13:02:45.607640 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:02:45.607779 [info ] [MainThread]:   retry_all: False
[0m13:02:45.607917 [info ] [MainThread]:   insecure_mode: False
[0m13:02:45.608061 [info ] [MainThread]:   reuse_connections: True
[0m13:02:45.608199 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:02:45.608597 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:02:45.676454 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:02:45.699973 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:02:45.700249 [debug] [MainThread]: On debug: select 1 as id
[0m13:02:45.700415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:48.808728 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.108 seconds
[0m13:02:48.811228 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:02:48.812139 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:02:48.816865 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4684494, "process_in_blocks": "0", "process_kernel_time": 0.204571, "process_mem_max_rss": "159088640", "process_out_blocks": "0", "process_user_time": 1.178499}
[0m13:02:48.818003 [debug] [MainThread]: Command `dbt debug` succeeded at 13:02:48.817714 after 3.47 seconds
[0m13:02:48.818617 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:02:48.819032 [debug] [MainThread]: On debug: Close
[0m13:02:48.914908 [debug] [MainThread]: Flushing usage events
<<<<<<< HEAD
[0m13:24:06.332169 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:24:06.343385 | 0983e98b-4842-47da-9aac-d1d140590ad7 ==============================
[0m13:24:06.343385 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:24:06.343896 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'empty': 'False', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_btc_transactions', 'target_path': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'profiles_dir': '/Users/mac/.dbt', 'warn_error': 'None', 'no_print': 'None'}
[0m13:24:06.344160 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:24:06.559673 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:24:06.630730 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:24:06.719575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:06.719848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:06.722781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m13:24:06.787152 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:24:06.788221 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:24:06.795113 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 479 macros
[0m13:24:06.795885 [info ] [MainThread]: 
[0m13:24:06.796107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:24:06.796272 [info ] [MainThread]: 
[0m13:24:06.796527 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:24:06.798695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc_btc_schema'
[0m13:24:06.830729 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m13:24:06.830954 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m13:24:06.831123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:10.009318 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.178 seconds
[0m13:24:10.012289 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m13:24:10.012602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_transactions)
[0m13:24:10.012864 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m13:24:10.018118 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m13:24:10.018866 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m13:24:10.019551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:10.019757 [debug] [MainThread]: Connection 'model.btc.stg_btc_transactions' was left open.
[0m13:24:10.019946 [debug] [MainThread]: On model.btc.stg_btc_transactions: Close
[0m13:24:10.114306 [info ] [MainThread]: 
[0m13:24:10.114804 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m13:24:10.115338 [debug] [MainThread]: Command end result
[0m13:24:10.134113 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:24:10.135487 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:24:10.137860 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m13:24:10.138258 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:24:10.140084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8341236, "process_in_blocks": "0", "process_kernel_time": 0.215975, "process_mem_max_rss": "165085184", "process_out_blocks": "0", "process_user_time": 1.310901}
[0m13:24:10.140397 [debug] [MainThread]: Command `dbt run` succeeded at 13:24:10.140345 after 3.83 seconds
[0m13:24:10.140625 [debug] [MainThread]: Flushing usage events
[0m13:25:54.821318 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:25:54.832438 | c525c5d5-845e-4cbb-83a8-f6de0c32da84 ==============================
[0m13:25:54.832438 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:25:54.832962 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/mac/.dbt', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'empty': 'False', 'target_path': 'None', 'write_json': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run -m models/stg_btc_transactions.sql', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default'}
[0m13:25:54.833231 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:25:55.052215 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:25:55.122853 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:25:55.215442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:55.215734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:55.218758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m13:25:55.282891 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:25:55.283953 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:25:55.290791 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 479 macros
[0m13:25:55.291820 [info ] [MainThread]: 
[0m13:25:55.292041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:55.292216 [info ] [MainThread]: 
[0m13:25:55.292483 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:25:55.294649 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc_btc_schema'
[0m13:25:55.326796 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m13:25:55.327058 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m13:25:55.327230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:56.942653 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.615 seconds
[0m13:25:56.950434 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m13:25:56.951134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_transactions)
[0m13:25:56.951626 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m13:25:56.960552 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m13:25:56.961719 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m13:25:56.962783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:56.963109 [debug] [MainThread]: Connection 'model.btc.stg_btc_transactions' was left open.
[0m13:25:56.963409 [debug] [MainThread]: On model.btc.stg_btc_transactions: Close
[0m13:25:57.061203 [info ] [MainThread]: 
[0m13:25:57.061975 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m13:25:57.062633 [debug] [MainThread]: Command end result
[0m13:25:57.086263 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:25:57.087762 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:25:57.090351 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m13:25:57.090800 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:25:57.092854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2979283, "process_in_blocks": "0", "process_kernel_time": 0.209278, "process_mem_max_rss": "164757504", "process_out_blocks": "0", "process_user_time": 1.308548}
[0m13:25:57.093236 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:57.093174 after 2.30 seconds
[0m13:25:57.093521 [debug] [MainThread]: Flushing usage events
[0m13:27:45.337487 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:27:45.348635 | 4ead77f4-fb98-4035-95da-5cc9381f6b61 ==============================
[0m13:27:45.348635 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:27:45.349171 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select stg_btc_transactions', 'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'write_json': 'True'}
[0m13:27:45.562577 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:27:45.633431 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:27:45.723284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:45.723568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:45.726509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m13:27:45.791179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:27:45.792497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:27:45.799287 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 479 macros
[0m13:27:45.800033 [info ] [MainThread]: 
[0m13:27:45.800238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:45.800409 [info ] [MainThread]: 
[0m13:27:45.800673 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:27:45.802862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc_btc_schema'
[0m13:27:45.834999 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m13:27:45.835232 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m13:27:45.835405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:49.045617 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.210 seconds
[0m13:27:49.053379 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m13:27:49.054104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_transactions)
[0m13:27:49.054615 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m13:27:49.063715 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m13:27:49.064982 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m13:27:49.066092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:49.066404 [debug] [MainThread]: Connection 'model.btc.stg_btc_transactions' was left open.
[0m13:27:49.066674 [debug] [MainThread]: On model.btc.stg_btc_transactions: Close
[0m13:27:49.158481 [info ] [MainThread]: 
[0m13:27:49.159176 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m13:27:49.159821 [debug] [MainThread]: Command end result
[0m13:27:49.182491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:27:49.183919 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:27:49.186505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m13:27:49.188509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8770888, "process_in_blocks": "0", "process_kernel_time": 0.218191, "process_mem_max_rss": "165609472", "process_out_blocks": "0", "process_user_time": 1.336748}
[0m13:27:49.188878 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:49.188815 after 3.88 seconds
[0m13:27:49.189148 [debug] [MainThread]: Flushing usage events
[0m13:30:09.332402 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:30:09.344267 | ab7bf23b-ed3f-4285-ac13-56e6a9dc32e7 ==============================
[0m13:30:09.344267 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:30:09.344805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_btc_outputs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'version_check': 'True', 'debug': 'False', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/Users/mac/.dbt', 'log_cache_events': 'False'}
[0m13:30:09.565691 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:30:09.636211 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:30:09.726056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:09.726340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:09.729296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.btc.example
[0m13:30:09.793776 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:30:09.794855 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:30:09.801743 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 479 macros
[0m13:30:09.802511 [info ] [MainThread]: 
[0m13:30:09.802711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:09.802871 [info ] [MainThread]: 
[0m13:30:09.803130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:30:09.803557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m13:30:09.832536 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m13:30:09.832774 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m13:30:09.832940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:12.940908 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.108 seconds
[0m13:30:12.950760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m13:30:12.964972 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m13:30:12.965351 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m13:30:13.066099 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.100 seconds
[0m13:30:13.072553 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m13:30:13.073176 [info ] [Thread-1 (]: 1 of 1 START sql incremental model btc_schema.stg_btc_outputs .................. [RUN]
[0m13:30:13.073713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc_outputs)
[0m13:30:13.074141 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m13:30:13.087856 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m13:30:13.089605 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m13:30:13.125021 [debug] [Thread-1 (]: Dropping relation btc.btc_schema.stg_btc_outputs because it is a view and this model is a table.
[0m13:30:13.129570 [debug] [Thread-1 (]: Applying DROP to: "BTC"."BTC_SCHEMA"."STG_BTC_OUTPUTS"
[0m13:30:13.133951 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:30:13.134219 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: drop view if exists "BTC"."BTC_SCHEMA"."STG_BTC_OUTPUTS" cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:30:13.254578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m13:30:13.270828 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m13:30:13.272325 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:30:13.272680 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace transient table btc.btc_schema.stg_btc_outputs
    
    
    
    as (-- including incremental logic to only load new data


with flattened as (
select
    t.hashkey,
    t.block_number,
    t.block_timestamp,
    t.is_coinbase,
    op.value:value::FLOAT as output_value,
    op.value:address::STRING as output_address 

from btc.btc_schema.stg_btc as t,
lateral flatten(input => t.outputs) as op
where op.value is not null



)

select hashkey,
    block_number,
    block_timestamp,
    is_coinbase,
    output_value,
    output_address
from flattened
    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m13:30:14.905953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.633 seconds
[0m13:30:14.914883 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc_outputs__dbt_tmp
[0m13:30:14.918124 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:30:14.918637 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: drop view if exists btc.btc_schema.stg_btc_outputs__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:30:14.992632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m13:30:15.018851 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model btc_schema.stg_btc_outputs ............. [[32mSUCCESS 1[0m in 1.94s]
[0m13:30:15.019439 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m13:30:15.020517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:15.020887 [debug] [MainThread]: Connection 'model.btc.stg_btc_outputs' was left open.
[0m13:30:15.021212 [debug] [MainThread]: On model.btc.stg_btc_outputs: Close
[0m13:30:15.101396 [info ] [MainThread]: 
[0m13:30:15.102008 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m13:30:15.102784 [debug] [MainThread]: Command end result
[0m13:30:15.122631 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:30:15.124167 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:30:15.128628 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m13:30:15.128911 [info ] [MainThread]: 
[0m13:30:15.129226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:15.129466 [info ] [MainThread]: 
[0m13:30:15.129709 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:30:15.131626 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.826516, "process_in_blocks": "0", "process_kernel_time": 0.225935, "process_mem_max_rss": "166150144", "process_out_blocks": "0", "process_user_time": 1.489719}
[0m13:30:15.131966 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:15.131908 after 5.83 seconds
[0m13:30:15.132237 [debug] [MainThread]: Flushing usage events
[0m13:36:37.993921 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:36:38.005357 | 5163167a-e1ba-4b89-bb0c-a6a9bc717079 ==============================
[0m13:36:38.005357 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:36:38.005875 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt debug', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_cache_events': 'False', 'use_colors': 'True', 'log_format': 'default'}
[0m13:36:38.012448 [info ] [MainThread]: dbt version: 1.10.11
[0m13:36:38.012685 [info ] [MainThread]: python version: 3.12.0
[0m13:36:38.012870 [info ] [MainThread]: python path: /Users/mac/Desktop/DE2025/btc/venv/bin/python
[0m13:36:38.013033 [info ] [MainThread]: os info: macOS-26.0-arm64-arm-64bit
[0m13:36:38.146619 [info ] [MainThread]: Using profiles dir at /Users/mac/.dbt
[0m13:36:38.146941 [info ] [MainThread]: Using profiles.yml file at /Users/mac/.dbt/profiles.yml
[0m13:36:38.147121 [info ] [MainThread]: Using dbt_project.yml file at /Users/mac/Desktop/DE2025/btc/dbt_project.yml
[0m13:36:38.147401 [info ] [MainThread]: adapter type: snowflake
[0m13:36:38.147562 [info ] [MainThread]: adapter version: 1.10.2
[0m13:36:38.200885 [info ] [MainThread]: Configuration:
[0m13:36:38.201228 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:36:38.201420 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:36:38.201591 [info ] [MainThread]: Required dependencies:
[0m13:36:38.201798 [debug] [MainThread]: Executing "git --help"
[0m13:36:38.211092 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:36:38.211662 [debug] [MainThread]: STDERR: "b''"
[0m13:36:38.211890 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:36:38.212094 [info ] [MainThread]: Connection:
[0m13:36:38.212291 [info ] [MainThread]:   account: KTPPEJB-WW82576
[0m13:36:38.212455 [info ] [MainThread]:   user: carlos
[0m13:36:38.212611 [info ] [MainThread]:   database: btc
[0m13:36:38.212768 [info ] [MainThread]:   warehouse: btc
[0m13:36:38.212915 [info ] [MainThread]:   role: accountadmin
[0m13:36:38.213059 [info ] [MainThread]:   schema: btc_schema
[0m13:36:38.213207 [info ] [MainThread]:   authenticator: None
[0m13:36:38.213360 [info ] [MainThread]:   oauth_client_id: None
[0m13:36:38.213500 [info ] [MainThread]:   query_tag: None
[0m13:36:38.213646 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:36:38.213786 [info ] [MainThread]:   host: None
[0m13:36:38.213944 [info ] [MainThread]:   port: None
[0m13:36:38.214083 [info ] [MainThread]:   proxy_host: None
[0m13:36:38.214223 [info ] [MainThread]:   proxy_port: None
[0m13:36:38.214365 [info ] [MainThread]:   protocol: None
[0m13:36:38.214509 [info ] [MainThread]:   connect_retries: 1
[0m13:36:38.214647 [info ] [MainThread]:   connect_timeout: None
[0m13:36:38.214795 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:36:38.214937 [info ] [MainThread]:   retry_all: False
[0m13:36:38.215076 [info ] [MainThread]:   insecure_mode: False
[0m13:36:38.215213 [info ] [MainThread]:   reuse_connections: True
[0m13:36:38.215355 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m13:36:38.215714 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:36:38.281899 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:36:38.304038 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:36:38.304281 [debug] [MainThread]: On debug: select 1 as id
[0m13:36:38.304442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:41.495172 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.191 seconds
[0m13:36:41.496671 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:36:41.497303 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:36:41.501056 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.5333333, "process_in_blocks": "0", "process_kernel_time": 0.20448, "process_mem_max_rss": "160448512", "process_out_blocks": "0", "process_user_time": 1.125823}
[0m13:36:41.502065 [debug] [MainThread]: Command `dbt debug` succeeded at 13:36:41.501771 after 3.53 seconds
[0m13:36:41.503747 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:36:41.504118 [debug] [MainThread]: On debug: Close
[0m13:36:41.600257 [debug] [MainThread]: Flushing usage events
[0m13:36:51.128075 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:36:51.140716 | 9ad4ca93-5536-45ae-869e-dfecf359bdd9 ==============================
[0m13:36:51.140716 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:36:51.141242 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'profiles_dir': '/Users/mac/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'write_json': 'True', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'empty': 'False', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m13:36:51.352207 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:36:51.422268 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:36:51.510907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:51.511190 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:51.576030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:36:51.577073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:36:51.591701 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 479 macros
[0m13:36:51.592796 [info ] [MainThread]: 
[0m13:36:51.593008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:51.593175 [info ] [MainThread]: 
[0m13:36:51.593433 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:36:51.595559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m13:36:51.623705 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m13:36:51.623939 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m13:36:51.624099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:54.842094 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.218 seconds
[0m13:36:54.846208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m13:36:54.861727 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m13:36:54.862153 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m13:36:54.986618 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.124 seconds
[0m13:36:54.993054 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m13:36:54.993732 [info ] [Thread-1 (]: 1 of 5 START sql incremental model btc_schema.stg_btc .......................... [RUN]
[0m13:36:54.994319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m13:36:54.994769 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m13:36:55.009837 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m13:36:55.010719 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m13:36:55.050542 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:36:55.050912 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace  temporary view btc.btc_schema.stg_btc__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


select * from btc.btc_schema.btc



    where block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc)


  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:36:55.242403 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m13:36:55.255579 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:36:55.256278 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:36:55.335618 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.079 seconds
[0m13:36:55.342837 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:36:55.343426 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:36:55.479410 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.135 seconds
[0m13:36:55.491947 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:36:55.492552 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table "BTC"."BTC_SCHEMA"."STG_BTC"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:36:55.573688 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.081 seconds
[0m13:36:55.608902 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m13:36:55.610413 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:36:55.610712 [debug] [Thread-1 (]: On model.btc.stg_btc: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:36:55.703081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m13:36:55.703662 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:36:55.704173 [debug] [Thread-1 (]: On model.btc.stg_btc: merge into btc.btc_schema.stg_btc as DBT_INTERNAL_DEST
        using btc.btc_schema.stg_btc__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.hashkey = DBT_INTERNAL_DEST.hashkey))

    
    when matched then update set
        "HASHKEY" = DBT_INTERNAL_SOURCE."HASHKEY","BLOCK_HASH" = DBT_INTERNAL_SOURCE."BLOCK_HASH","BLOCK_NUMBER" = DBT_INTERNAL_SOURCE."BLOCK_NUMBER","BLOCK_TIMESTAMP" = DBT_INTERNAL_SOURCE."BLOCK_TIMESTAMP","FEE" = DBT_INTERNAL_SOURCE."FEE","INPUT_VALUE" = DBT_INTERNAL_SOURCE."INPUT_VALUE","OUTPUT_BTC" = DBT_INTERNAL_SOURCE."OUTPUT_BTC","FEE_PER_BYTE" = DBT_INTERNAL_SOURCE."FEE_PER_BYTE","IS_COINBASE" = DBT_INTERNAL_SOURCE."IS_COINBASE","OUTPUTS" = DBT_INTERNAL_SOURCE."OUTPUTS"
    

    when not matched then insert
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")
    values
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:36:57.157037 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.452 seconds
[0m13:36:57.158463 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:36:57.159451 [debug] [Thread-1 (]: On model.btc.stg_btc: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:36:57.419787 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m13:36:57.434365 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc__dbt_tmp
[0m13:36:57.442026 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:36:57.442424 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists btc.btc_schema.stg_btc__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:36:57.560030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m13:36:57.587060 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model btc_schema.stg_btc ..................... [[32mSUCCESS 0[0m in 2.59s]
[0m13:36:57.587712 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m13:36:57.588510 [debug] [Thread-1 (]: Began running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m13:36:57.588917 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_btc_HASHKEY ..................................... [RUN]
[0m13:36:57.589322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc, now test.btc.not_null_stg_btc_HASHKEY.f1464799d5)
[0m13:36:57.589633 [debug] [Thread-1 (]: Began compiling node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m13:36:57.599240 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m13:36:57.600305 [debug] [Thread-1 (]: Began executing node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m13:36:57.615500 [debug] [Thread-1 (]: Writing runtime sql for node "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m13:36:57.616792 [debug] [Thread-1 (]: Using snowflake connection "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m13:36:57.617113 [debug] [Thread-1 (]: On test.btc.not_null_stg_btc_HASHKEY.f1464799d5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select HASHKEY
from btc.btc_schema.stg_btc
where HASHKEY is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"} */
[0m13:36:57.753818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m13:36:57.757762 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_btc_HASHKEY ........................................... [[32mPASS[0m in 0.17s]
[0m13:36:57.758344 [debug] [Thread-1 (]: Finished running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m13:36:57.758703 [debug] [Thread-1 (]: Began running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m13:36:57.759123 [info ] [Thread-1 (]: 3 of 5 START test unique_stg_btc_HASHKEY ....................................... [RUN]
[0m13:36:57.759583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.btc.not_null_stg_btc_HASHKEY.f1464799d5, now test.btc.unique_stg_btc_HASHKEY.3bc82edb0f)
[0m13:36:57.759922 [debug] [Thread-1 (]: Began compiling node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m13:36:57.765667 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m13:36:57.766685 [debug] [Thread-1 (]: Began executing node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m13:36:57.770314 [debug] [Thread-1 (]: Writing runtime sql for node "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m13:36:57.773266 [debug] [Thread-1 (]: Using snowflake connection "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m13:36:57.774092 [debug] [Thread-1 (]: On test.btc.unique_stg_btc_HASHKEY.3bc82edb0f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    HASHKEY as unique_field,
    count(*) as n_records

from btc.btc_schema.stg_btc
where HASHKEY is not null
group by HASHKEY
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"} */
[0m13:36:59.017531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.242 seconds
[0m13:36:59.023979 [info ] [Thread-1 (]: 3 of 5 PASS unique_stg_btc_HASHKEY ............................................. [[32mPASS[0m in 1.26s]
[0m13:36:59.025278 [debug] [Thread-1 (]: Finished running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m13:36:59.026303 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m13:36:59.027187 [info ] [Thread-1 (]: 4 of 5 START sql incremental model btc_schema.stg_btc_outputs .................. [RUN]
[0m13:36:59.027758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.btc.unique_stg_btc_HASHKEY.3bc82edb0f, now model.btc.stg_btc_outputs)
[0m13:36:59.028211 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m13:36:59.033115 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m13:36:59.034119 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m13:36:59.038169 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:36:59.038623 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace  temporary view btc.btc_schema.stg_btc_outputs__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


with flattened as (
select
    t.hashkey,
    t.block_number,
    t.block_timestamp,
    t.is_coinbase,
    op.value:value::FLOAT as output_value,
    op.value:address::STRING as output_address 

from btc.btc_schema.stg_btc as t,
lateral flatten(input => t.outputs) as op
where op.value is not null



    and t.block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc_outputs)


)

select hashkey,
    block_number,
    block_timestamp,
    is_coinbase,
    output_value,
    output_address
from flattened
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m13:36:59.258308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m13:36:59.264143 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:36:59.265103 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:36:59.331771 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.066 seconds
[0m13:36:59.338740 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:36:59.339453 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:36:59.412715 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.072 seconds
[0m13:36:59.419463 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:36:59.420195 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table "BTC"."BTC_SCHEMA"."STG_BTC_OUTPUTS"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:36:59.511163 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.090 seconds
[0m13:36:59.522864 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m13:36:59.524557 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:36:59.525051 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:36:59.618155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m13:36:59.619703 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:36:59.620806 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: insert into btc.btc_schema.stg_btc_outputs ("HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS")
    (
        select "HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS"
        from btc.btc_schema.stg_btc_outputs__dbt_tmp
    )


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m13:37:00.978161 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.356 seconds
[0m13:37:00.979565 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:00.980151 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:37:01.166960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m13:37:01.172843 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc_outputs__dbt_tmp
[0m13:37:01.176358 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:01.176847 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: drop view if exists btc.btc_schema.stg_btc_outputs__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:37:01.277224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m13:37:01.282082 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model btc_schema.stg_btc_outputs ............. [[32mSUCCESS 0[0m in 2.25s]
[0m13:37:01.282993 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m13:37:01.283969 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m13:37:01.284530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_outputs, now model.btc.stg_btc_transactions)
[0m13:37:01.285024 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m13:37:01.288835 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m13:37:01.290157 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m13:37:01.291026 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m13:37:01.291692 [info ] [Thread-1 (]: 5 of 5 START sql tables model btc_schema.whale_alerts .......................... [RUN]
[0m13:37:01.292230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_transactions, now model.btc.whale_alerts)
[0m13:37:01.292661 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m13:37:01.297636 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m13:37:01.298687 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m13:37:01.302406 [debug] [Thread-1 (]: Compilation Error in model whale_alerts (models/marts/whale_alerts.sql)
  No materialization 'tables' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m13:37:01.303084 [error] [Thread-1 (]: 5 of 5 ERROR creating sql tables model btc_schema.whale_alerts ................. [[31mERROR[0m in 0.01s]
[0m13:37:01.303596 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m13:37:01.304016 [debug] [Thread-4 (]: Marking all children of 'model.btc.whale_alerts' to be skipped because of status 'error'.  Reason: Compilation Error in model whale_alerts (models/marts/whale_alerts.sql)
  No materialization 'tables' was found for adapter snowflake! (searched types 'default' and 'snowflake').
[0m13:37:01.305170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:01.305457 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m13:37:01.305719 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m13:37:01.397954 [info ] [MainThread]: 
[0m13:37:01.398519 [info ] [MainThread]: Finished running 2 incremental models, 1 tables model, 2 data tests in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m13:37:01.399606 [debug] [MainThread]: Command end result
[0m13:37:01.417501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:37:01.418985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:37:01.423371 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m13:37:01.423629 [info ] [MainThread]: 
[0m13:37:01.423933 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:37:01.424165 [info ] [MainThread]: 
[0m13:37:01.424435 [error] [MainThread]: [31mFailure in model whale_alerts (models/marts/whale_alerts.sql)[0m
[0m13:37:01.424685 [error] [MainThread]:   Compilation Error in model whale_alerts (models/marts/whale_alerts.sql)
  No materialization 'tables' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m13:37:01.424881 [info ] [MainThread]: 
[0m13:37:01.425099 [info ] [MainThread]:   compiled code at target/compiled/btc/models/marts/whale_alerts.sql
[0m13:37:01.425282 [info ] [MainThread]: 
[0m13:37:01.425490 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m13:37:01.427508 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 10.325763, "process_in_blocks": "0", "process_kernel_time": 0.239033, "process_mem_max_rss": "169082880", "process_out_blocks": "0", "process_user_time": 1.718235}
[0m13:37:01.427827 [debug] [MainThread]: Command `dbt build` failed at 13:37:01.427772 after 10.33 seconds
[0m13:37:01.428087 [debug] [MainThread]: Flushing usage events
[0m13:37:35.139334 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:37:35.152808 | 79febceb-43b9-456d-8f5b-c57b07b74eda ==============================
[0m13:37:35.152808 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:37:35.153373 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'log_format': 'default', 'invocation_command': 'dbt build', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'empty': 'False', 'printer_width': '80', 'profiles_dir': '/Users/mac/.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'introspect': 'True'}
[0m13:37:35.378341 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:37:35.450316 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:37:35.549788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:35.550228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:35.624874 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:37:35.626115 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:37:35.639758 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 479 macros
[0m13:37:35.640929 [info ] [MainThread]: 
[0m13:37:35.641154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:37:35.641325 [info ] [MainThread]: 
[0m13:37:35.641609 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:37:35.643841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m13:37:35.674510 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m13:37:35.674793 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m13:37:35.674955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:38.785487 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.110 seconds
[0m13:37:38.790384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m13:37:38.805779 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m13:37:38.806165 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m13:37:38.935163 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.129 seconds
[0m13:37:38.943374 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m13:37:38.944319 [info ] [Thread-1 (]: 1 of 5 START sql incremental model btc_schema.stg_btc .......................... [RUN]
[0m13:37:38.944979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m13:37:38.945444 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m13:37:38.966946 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m13:37:38.968828 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m13:37:39.006435 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:37:39.006798 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace  temporary view btc.btc_schema.stg_btc__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


select * from btc.btc_schema.btc



    where block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc)


  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:37:39.192028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m13:37:39.205387 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:37:39.206210 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:37:39.285119 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.078 seconds
[0m13:37:39.291959 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:37:39.292516 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:37:39.364427 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.071 seconds
[0m13:37:39.377794 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:37:39.378419 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table "BTC"."BTC_SCHEMA"."STG_BTC"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:37:39.450372 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.071 seconds
[0m13:37:39.489918 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m13:37:39.491356 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:37:39.491650 [debug] [Thread-1 (]: On model.btc.stg_btc: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:37:39.584993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m13:37:39.585593 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:37:39.586100 [debug] [Thread-1 (]: On model.btc.stg_btc: merge into btc.btc_schema.stg_btc as DBT_INTERNAL_DEST
        using btc.btc_schema.stg_btc__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.hashkey = DBT_INTERNAL_DEST.hashkey))

    
    when matched then update set
        "HASHKEY" = DBT_INTERNAL_SOURCE."HASHKEY","BLOCK_HASH" = DBT_INTERNAL_SOURCE."BLOCK_HASH","BLOCK_NUMBER" = DBT_INTERNAL_SOURCE."BLOCK_NUMBER","BLOCK_TIMESTAMP" = DBT_INTERNAL_SOURCE."BLOCK_TIMESTAMP","FEE" = DBT_INTERNAL_SOURCE."FEE","INPUT_VALUE" = DBT_INTERNAL_SOURCE."INPUT_VALUE","OUTPUT_BTC" = DBT_INTERNAL_SOURCE."OUTPUT_BTC","FEE_PER_BYTE" = DBT_INTERNAL_SOURCE."FEE_PER_BYTE","IS_COINBASE" = DBT_INTERNAL_SOURCE."IS_COINBASE","OUTPUTS" = DBT_INTERNAL_SOURCE."OUTPUTS"
    

    when not matched then insert
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")
    values
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:37:41.011031 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.424 seconds
[0m13:37:41.012067 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:37:41.012773 [debug] [Thread-1 (]: On model.btc.stg_btc: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:37:41.184533 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m13:37:41.193225 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc__dbt_tmp
[0m13:37:41.199770 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:37:41.200157 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists btc.btc_schema.stg_btc__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:37:41.311729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m13:37:41.334625 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model btc_schema.stg_btc ..................... [[32mSUCCESS 0[0m in 2.39s]
[0m13:37:41.335328 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m13:37:41.336092 [debug] [Thread-1 (]: Began running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m13:37:41.336570 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_btc_HASHKEY ..................................... [RUN]
[0m13:37:41.337056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc, now test.btc.not_null_stg_btc_HASHKEY.f1464799d5)
[0m13:37:41.337410 [debug] [Thread-1 (]: Began compiling node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m13:37:41.348856 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m13:37:41.349804 [debug] [Thread-1 (]: Began executing node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m13:37:41.366092 [debug] [Thread-1 (]: Writing runtime sql for node "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m13:37:41.367185 [debug] [Thread-1 (]: Using snowflake connection "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m13:37:41.367571 [debug] [Thread-1 (]: On test.btc.not_null_stg_btc_HASHKEY.f1464799d5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select HASHKEY
from btc.btc_schema.stg_btc
where HASHKEY is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"} */
[0m13:37:41.539392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m13:37:41.546506 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_btc_HASHKEY ........................................... [[32mPASS[0m in 0.21s]
[0m13:37:41.547495 [debug] [Thread-1 (]: Finished running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m13:37:41.548014 [debug] [Thread-1 (]: Began running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m13:37:41.548605 [info ] [Thread-1 (]: 3 of 5 START test unique_stg_btc_HASHKEY ....................................... [RUN]
[0m13:37:41.549246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.btc.not_null_stg_btc_HASHKEY.f1464799d5, now test.btc.unique_stg_btc_HASHKEY.3bc82edb0f)
[0m13:37:41.549727 [debug] [Thread-1 (]: Began compiling node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m13:37:41.557900 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m13:37:41.559167 [debug] [Thread-1 (]: Began executing node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m13:37:41.562255 [debug] [Thread-1 (]: Writing runtime sql for node "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m13:37:41.563489 [debug] [Thread-1 (]: Using snowflake connection "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m13:37:41.563847 [debug] [Thread-1 (]: On test.btc.unique_stg_btc_HASHKEY.3bc82edb0f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    HASHKEY as unique_field,
    count(*) as n_records

from btc.btc_schema.stg_btc
where HASHKEY is not null
group by HASHKEY
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"} */
[0m13:37:42.183795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m13:37:42.188070 [info ] [Thread-1 (]: 3 of 5 PASS unique_stg_btc_HASHKEY ............................................. [[32mPASS[0m in 0.64s]
[0m13:37:42.189039 [debug] [Thread-1 (]: Finished running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m13:37:42.190203 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m13:37:42.191201 [info ] [Thread-1 (]: 4 of 5 START sql incremental model btc_schema.stg_btc_outputs .................. [RUN]
[0m13:37:42.191821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.btc.unique_stg_btc_HASHKEY.3bc82edb0f, now model.btc.stg_btc_outputs)
[0m13:37:42.192239 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m13:37:42.196743 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m13:37:42.197975 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m13:37:42.203086 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:42.203674 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace  temporary view btc.btc_schema.stg_btc_outputs__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


with flattened as (
select
    t.hashkey,
    t.block_number,
    t.block_timestamp,
    t.is_coinbase,
    op.value:value::FLOAT as output_value,
    op.value:address::STRING as output_address 

from btc.btc_schema.stg_btc as t,
lateral flatten(input => t.outputs) as op
where op.value is not null



    and t.block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc_outputs)


)

select hashkey,
    block_number,
    block_timestamp,
    is_coinbase,
    output_value,
    output_address
from flattened
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m13:37:42.361565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m13:37:42.366989 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:42.367677 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:37:42.439708 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.071 seconds
[0m13:37:42.445949 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:42.446558 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:37:42.535691 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.088 seconds
[0m13:37:42.542027 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:42.542943 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table "BTC"."BTC_SCHEMA"."STG_BTC_OUTPUTS"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:37:42.618323 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.075 seconds
[0m13:37:42.629616 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m13:37:42.631193 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:42.631609 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:37:42.716616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m13:37:42.717977 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:42.718698 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: insert into btc.btc_schema.stg_btc_outputs ("HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS")
    (
        select "HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS"
        from btc.btc_schema.stg_btc_outputs__dbt_tmp
    )


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m13:37:43.139729 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.420 seconds
[0m13:37:43.140893 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:43.141451 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:37:43.254205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m13:37:43.260418 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc_outputs__dbt_tmp
[0m13:37:43.265312 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:37:43.266045 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: drop view if exists btc.btc_schema.stg_btc_outputs__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:37:43.401643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m13:37:43.406222 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model btc_schema.stg_btc_outputs ............. [[32mSUCCESS 0[0m in 1.21s]
[0m13:37:43.407665 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m13:37:43.408974 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m13:37:43.409769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_outputs, now model.btc.stg_btc_transactions)
[0m13:37:43.410315 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m13:37:43.414541 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m13:37:43.416162 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m13:37:43.417201 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m13:37:43.417915 [info ] [Thread-1 (]: 5 of 5 START sql table model btc_schema.whale_alerts ........................... [RUN]
[0m13:37:43.418471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_transactions, now model.btc.whale_alerts)
[0m13:37:43.418871 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m13:37:43.423936 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m13:37:43.425009 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m13:37:43.448962 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.whale_alerts"
[0m13:37:43.450522 [debug] [Thread-1 (]: Using snowflake connection "model.btc.whale_alerts"
[0m13:37:43.450839 [debug] [Thread-1 (]: On model.btc.whale_alerts: create or replace transient table btc.btc_schema.whale_alerts
    
    
    
    as (with __dbt__cte__stg_btc_transactions as (


select * 
from btc.btc_schema.stg_btc_outputs 
where is_coinbase = false
) select
    output_address,
    sum(output_value) as total_sent,
    count(*) as tx_count

from __dbt__cte__stg_btc_transactions

where output_value > 10

group by output_address
order by total_sent
    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.whale_alerts"} */;
[0m13:37:44.426520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.975 seconds
[0m13:37:44.432623 [info ] [Thread-1 (]: 5 of 5 OK created sql table model btc_schema.whale_alerts ...................... [[32mSUCCESS 1[0m in 1.01s]
[0m13:37:44.433910 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m13:37:44.435570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:44.436581 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m13:37:44.437049 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m13:37:44.532510 [info ] [MainThread]: 
[0m13:37:44.533547 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 2 data tests in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m13:37:44.535369 [debug] [MainThread]: Command end result
[0m13:37:44.560900 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:37:44.562865 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:37:44.568213 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m13:37:44.568542 [info ] [MainThread]: 
[0m13:37:44.568881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:44.569154 [info ] [MainThread]: 
[0m13:37:44.569424 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m13:37:44.571744 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.4614725, "process_in_blocks": "0", "process_kernel_time": 0.266092, "process_mem_max_rss": "169132032", "process_out_blocks": "0", "process_user_time": 1.846638}
[0m13:37:44.572276 [debug] [MainThread]: Command `dbt build` succeeded at 13:37:44.572204 after 9.46 seconds
[0m13:37:44.572592 [debug] [MainThread]: Flushing usage events
[0m13:38:06.591279 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:38:06.602507 | ee85bb87-c1d8-4529-aee8-7d0ffa24d268 ==============================
[0m13:38:06.602507 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:38:06.603039 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt run --select stg_btc+', 'debug': 'False', 'profiles_dir': '/Users/mac/.dbt', 'empty': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80'}
[0m13:38:06.819121 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:38:06.889611 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:38:06.984907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:06.985203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:07.050298 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:38:07.051334 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:38:07.058127 [info ] [MainThread]: Found 4 models, 2 data tests, 1 source, 479 macros
[0m13:38:07.058964 [info ] [MainThread]: 
[0m13:38:07.059170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:07.059341 [info ] [MainThread]: 
[0m13:38:07.059588 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:07.061752 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m13:38:07.090711 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m13:38:07.090988 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m13:38:07.091178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:10.175342 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.084 seconds
[0m13:38:10.180415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m13:38:10.193942 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m13:38:10.194407 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m13:38:10.533015 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.338 seconds
[0m13:38:10.540727 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m13:38:10.541661 [info ] [Thread-1 (]: 1 of 3 START sql incremental model btc_schema.stg_btc .......................... [RUN]
[0m13:38:10.542375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m13:38:10.542839 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m13:38:10.558521 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m13:38:10.559417 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m13:38:10.598481 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:38:10.598819 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace  temporary view btc.btc_schema.stg_btc__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


select * from btc.btc_schema.btc



    where block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc)


  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:38:10.813744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m13:38:10.825152 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:38:10.825603 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:38:10.918328 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.092 seconds
[0m13:38:10.925126 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:38:10.925847 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:38:10.995941 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.069 seconds
[0m13:38:11.010647 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:38:11.011212 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table "BTC"."BTC_SCHEMA"."STG_BTC"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:38:11.069602 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.058 seconds
[0m13:38:11.104916 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m13:38:11.106242 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:38:11.106529 [debug] [Thread-1 (]: On model.btc.stg_btc: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:38:11.200806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m13:38:11.201467 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:38:11.201979 [debug] [Thread-1 (]: On model.btc.stg_btc: merge into btc.btc_schema.stg_btc as DBT_INTERNAL_DEST
        using btc.btc_schema.stg_btc__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.hashkey = DBT_INTERNAL_DEST.hashkey))

    
    when matched then update set
        "HASHKEY" = DBT_INTERNAL_SOURCE."HASHKEY","BLOCK_HASH" = DBT_INTERNAL_SOURCE."BLOCK_HASH","BLOCK_NUMBER" = DBT_INTERNAL_SOURCE."BLOCK_NUMBER","BLOCK_TIMESTAMP" = DBT_INTERNAL_SOURCE."BLOCK_TIMESTAMP","FEE" = DBT_INTERNAL_SOURCE."FEE","INPUT_VALUE" = DBT_INTERNAL_SOURCE."INPUT_VALUE","OUTPUT_BTC" = DBT_INTERNAL_SOURCE."OUTPUT_BTC","FEE_PER_BYTE" = DBT_INTERNAL_SOURCE."FEE_PER_BYTE","IS_COINBASE" = DBT_INTERNAL_SOURCE."IS_COINBASE","OUTPUTS" = DBT_INTERNAL_SOURCE."OUTPUTS"
    

    when not matched then insert
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")
    values
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:38:11.956305 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.753 seconds
[0m13:38:11.957395 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:38:11.957934 [debug] [Thread-1 (]: On model.btc.stg_btc: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:38:12.216623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m13:38:12.230434 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc__dbt_tmp
[0m13:38:12.238384 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:38:12.238809 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists btc.btc_schema.stg_btc__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:38:12.396850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m13:38:12.423440 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model btc_schema.stg_btc ..................... [[32mSUCCESS 0[0m in 1.88s]
[0m13:38:12.424074 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m13:38:12.424768 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m13:38:12.425236 [info ] [Thread-1 (]: 2 of 3 START sql incremental model btc_schema.stg_btc_outputs .................. [RUN]
[0m13:38:12.425626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc, now model.btc.stg_btc_outputs)
[0m13:38:12.425933 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m13:38:12.429304 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m13:38:12.430117 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m13:38:12.433513 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:38:12.434105 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace  temporary view btc.btc_schema.stg_btc_outputs__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


with flattened as (
select
    t.hashkey,
    t.block_number,
    t.block_timestamp,
    t.is_coinbase,
    op.value:value::FLOAT as output_value,
    op.value:address::STRING as output_address 

from btc.btc_schema.stg_btc as t,
lateral flatten(input => t.outputs) as op
where op.value is not null



    and t.block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc_outputs)


)

select hashkey,
    block_number,
    block_timestamp,
    is_coinbase,
    output_value,
    output_address
from flattened
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m13:38:12.669745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m13:38:12.675771 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:38:12.676545 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:38:12.747129 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.070 seconds
[0m13:38:12.749498 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:38:12.749797 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:38:12.809068 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.059 seconds
[0m13:38:12.811282 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:38:12.811502 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table "BTC"."BTC_SCHEMA"."STG_BTC_OUTPUTS"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:38:12.885282 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.074 seconds
[0m13:38:12.891673 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m13:38:12.892529 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:38:12.892805 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:38:12.979900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m13:38:12.980399 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:38:12.980802 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: insert into btc.btc_schema.stg_btc_outputs ("HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS")
    (
        select "HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS"
        from btc.btc_schema.stg_btc_outputs__dbt_tmp
    )


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m13:38:13.315403 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.334 seconds
[0m13:38:13.315762 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:38:13.315964 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:38:13.399111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m13:38:13.403153 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc_outputs__dbt_tmp
[0m13:38:13.403977 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:38:13.404282 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: drop view if exists btc.btc_schema.stg_btc_outputs__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:38:13.524936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m13:38:13.528662 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model btc_schema.stg_btc_outputs ............. [[32mSUCCESS 0[0m in 1.10s]
[0m13:38:13.529514 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m13:38:13.530312 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m13:38:13.530942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_outputs, now model.btc.stg_btc_transactions)
[0m13:38:13.531517 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m13:38:13.535217 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m13:38:13.536350 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m13:38:13.537014 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m13:38:13.537668 [info ] [Thread-1 (]: 3 of 3 START sql table model btc_schema.whale_alerts ........................... [RUN]
[0m13:38:13.538212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_transactions, now model.btc.whale_alerts)
[0m13:38:13.538606 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m13:38:13.543627 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m13:38:13.544260 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m13:38:13.565560 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.whale_alerts"
[0m13:38:13.566638 [debug] [Thread-1 (]: Using snowflake connection "model.btc.whale_alerts"
[0m13:38:13.566935 [debug] [Thread-1 (]: On model.btc.whale_alerts: create or replace transient table btc.btc_schema.whale_alerts
    
    
    
    as (with __dbt__cte__stg_btc_transactions as (


select * 
from btc.btc_schema.stg_btc_outputs 
where is_coinbase = false
) select
    output_address,
    sum(output_value) as total_sent,
    count(*) as tx_count

from __dbt__cte__stg_btc_transactions

where output_value > 10

group by output_address
order by total_sent
    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.whale_alerts"} */;
[0m13:38:14.527050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.960 seconds
[0m13:38:14.536718 [info ] [Thread-1 (]: 3 of 3 OK created sql table model btc_schema.whale_alerts ...................... [[32mSUCCESS 1[0m in 1.00s]
[0m13:38:14.537826 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m13:38:14.539119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:14.539602 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m13:38:14.539982 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m13:38:14.629817 [info ] [MainThread]: 
[0m13:38:14.630659 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m13:38:14.631910 [debug] [MainThread]: Command end result
[0m13:38:14.657143 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:38:14.658781 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:38:14.663636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m13:38:14.663920 [info ] [MainThread]: 
[0m13:38:14.664232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:14.664480 [info ] [MainThread]: 
[0m13:38:14.664744 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:38:14.666806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.102563, "process_in_blocks": "0", "process_kernel_time": 0.240092, "process_mem_max_rss": "167362560", "process_out_blocks": "0", "process_user_time": 1.657058}
[0m13:38:14.667157 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:14.667101 after 8.10 seconds
[0m13:38:14.667406 [debug] [MainThread]: Flushing usage events
[0m13:42:06.828694 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:42:06.842482 | 10b503cb-49ee-4130-a2d0-6a19736936cd ==============================
[0m13:42:06.842482 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:42:06.843049 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'None', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'quiet': 'False', 'introspect': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt seed'}
[0m13:42:07.056330 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:42:07.127970 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:42:07.218968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:42:07.219365 [debug] [MainThread]: Partial parsing: added file: btc://seeds/btc_usd_max.csv
[0m13:42:07.389143 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:42:07.390190 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:42:07.397240 [info ] [MainThread]: Found 4 models, 2 data tests, 1 seed, 1 source, 479 macros
[0m13:42:07.398111 [info ] [MainThread]: 
[0m13:42:07.398322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:42:07.398489 [info ] [MainThread]: 
[0m13:42:07.398735 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:07.399177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m13:42:07.426433 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m13:42:07.426669 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m13:42:07.426854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:11.014525 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.587 seconds
[0m13:42:11.023433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m13:42:11.038052 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m13:42:11.038435 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m13:42:11.129384 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.091 seconds
[0m13:42:11.135338 [debug] [Thread-1 (]: Began running node seed.btc.btc_usd_max
[0m13:42:11.135954 [info ] [Thread-1 (]: 1 of 1 START seed file btc_schema.btc_usd_max .................................. [RUN]
[0m13:42:11.136495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now seed.btc.btc_usd_max)
[0m13:42:11.136923 [debug] [Thread-1 (]: Began compiling node seed.btc.btc_usd_max
[0m13:42:11.137333 [debug] [Thread-1 (]: Began executing node seed.btc.btc_usd_max
[0m13:42:11.227911 [debug] [Thread-1 (]: Using snowflake connection "seed.btc.btc_usd_max"
[0m13:42:11.228229 [debug] [Thread-1 (]: On seed.btc.btc_usd_max: create table btc.btc_schema.btc_usd_max (snapped_at text,price float8,market_cap float8,total_volume float8)
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "seed.btc.btc_usd_max"} */
[0m13:42:11.414274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m13:42:11.482631 [debug] [Thread-1 (]: Using snowflake connection "seed.btc.btc_usd_max"
[0m13:42:11.482960 [debug] [Thread-1 (]: On seed.btc.btc_usd_max: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "seed.btc.btc_usd_max"} */
[0m13:42:11.566522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m13:42:11.744280 [debug] [Thread-1 (]: Using snowflake connection "seed.btc.btc_usd_max"
[0m13:42:11.744587 [debug] [Thread-1 (]: On seed.btc.btc_usd_max: insert into btc.btc_schema.btc_usd_max (snapped_at, price, market_cap, total_volume) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m13:42:13.346526 [debug] [Thread-1 (]: SQL status: SUCCESS 4524 in 1.601 seconds
[0m13:42:13.348235 [debug] [Thread-1 (]: Using snowflake connection "seed.btc.btc_usd_max"
[0m13:42:13.348657 [debug] [Thread-1 (]: On seed.btc.btc_usd_max: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "seed.btc.btc_usd_max"} */
[0m13:42:13.582656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m13:42:13.593218 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.btc.btc_usd_max"
[0m13:42:13.616261 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file btc_schema.btc_usd_max .............................. [[32mINSERT 4524[0m in 2.48s]
[0m13:42:13.616755 [debug] [Thread-1 (]: Finished running node seed.btc.btc_usd_max
[0m13:42:13.617627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:13.617923 [debug] [MainThread]: Connection 'seed.btc.btc_usd_max' was left open.
[0m13:42:13.618174 [debug] [MainThread]: On seed.btc.btc_usd_max: Close
[0m13:42:13.720200 [info ] [MainThread]: 
[0m13:42:13.720556 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m13:42:13.720970 [debug] [MainThread]: Command end result
[0m13:42:13.733129 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:42:13.734227 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:42:13.737335 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m13:42:13.737530 [info ] [MainThread]: 
[0m13:42:13.737752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:42:13.737917 [info ] [MainThread]: 
[0m13:42:13.738088 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:42:13.739849 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.937305, "process_in_blocks": "0", "process_kernel_time": 0.23754, "process_mem_max_rss": "174014464", "process_out_blocks": "0", "process_user_time": 1.863117}
[0m13:42:13.740202 [debug] [MainThread]: Command `dbt seed` succeeded at 13:42:13.740145 after 6.94 seconds
[0m13:42:13.740422 [debug] [MainThread]: Flushing usage events
[0m13:57:33.569235 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:57:33.581487 | b504859b-ea21-4fbb-ba88-f6c15c017f1a ==============================
[0m13:57:33.581487 [info ] [MainThread]: Running with dbt=1.10.11
[0m13:57:33.582036 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/mac/.dbt', 'fail_fast': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select stg_btc+', 'no_print': 'None', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'introspect': 'True'}
[0m13:57:33.796992 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:57:33.868436 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m13:57:33.963958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:33.964240 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:34.039137 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:57:34.040750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:57:34.048760 [info ] [MainThread]: Found 4 models, 2 data tests, 1 seed, 1 source, 479 macros
[0m13:57:34.049681 [info ] [MainThread]: 
[0m13:57:34.049897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:34.050067 [info ] [MainThread]: 
[0m13:57:34.050328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:57:34.052512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m13:57:34.081780 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m13:57:34.082060 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m13:57:34.082243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:37.151444 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.066 seconds
[0m13:57:37.154511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m13:57:37.167763 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m13:57:37.168173 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m13:57:37.290260 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.122 seconds
[0m13:57:37.297356 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m13:57:37.297952 [info ] [Thread-1 (]: 1 of 3 START sql incremental model btc_schema.stg_btc .......................... [RUN]
[0m13:57:37.298443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m13:57:37.298813 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m13:57:37.310993 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m13:57:37.311932 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m13:57:37.348696 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:57:37.349062 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace  temporary view btc.btc_schema.stg_btc__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


select * from btc.btc_schema.btc



    where block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc)


  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:57:37.594132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m13:57:37.601513 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:57:37.602019 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:57:37.669979 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.068 seconds
[0m13:57:37.674933 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:57:37.675407 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:57:37.752407 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.076 seconds
[0m13:57:37.765210 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:57:37.765740 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table "BTC"."BTC_SCHEMA"."STG_BTC"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:57:37.866368 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.100 seconds
[0m13:57:37.903354 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m13:57:37.905717 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:57:37.906035 [debug] [Thread-1 (]: On model.btc.stg_btc: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:57:37.994295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m13:57:37.994944 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:57:37.995393 [debug] [Thread-1 (]: On model.btc.stg_btc: merge into btc.btc_schema.stg_btc as DBT_INTERNAL_DEST
        using btc.btc_schema.stg_btc__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.hashkey = DBT_INTERNAL_DEST.hashkey))

    
    when matched then update set
        "HASHKEY" = DBT_INTERNAL_SOURCE."HASHKEY","BLOCK_HASH" = DBT_INTERNAL_SOURCE."BLOCK_HASH","BLOCK_NUMBER" = DBT_INTERNAL_SOURCE."BLOCK_NUMBER","BLOCK_TIMESTAMP" = DBT_INTERNAL_SOURCE."BLOCK_TIMESTAMP","FEE" = DBT_INTERNAL_SOURCE."FEE","INPUT_VALUE" = DBT_INTERNAL_SOURCE."INPUT_VALUE","OUTPUT_BTC" = DBT_INTERNAL_SOURCE."OUTPUT_BTC","FEE_PER_BYTE" = DBT_INTERNAL_SOURCE."FEE_PER_BYTE","IS_COINBASE" = DBT_INTERNAL_SOURCE."IS_COINBASE","OUTPUTS" = DBT_INTERNAL_SOURCE."OUTPUTS"
    

    when not matched then insert
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")
    values
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */;
[0m13:57:38.877736 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.881 seconds
[0m13:57:38.879147 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:57:38.879904 [debug] [Thread-1 (]: On model.btc.stg_btc: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:57:39.161733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.281 seconds
[0m13:57:39.168084 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc__dbt_tmp
[0m13:57:39.173659 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m13:57:39.174042 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists btc.btc_schema.stg_btc__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc"} */
[0m13:57:39.263430 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m13:57:39.281432 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model btc_schema.stg_btc ..................... [[32mSUCCESS 0[0m in 1.98s]
[0m13:57:39.281998 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m13:57:39.282646 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m13:57:39.282979 [info ] [Thread-1 (]: 2 of 3 START sql incremental model btc_schema.stg_btc_outputs .................. [RUN]
[0m13:57:39.283305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc, now model.btc.stg_btc_outputs)
[0m13:57:39.283547 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m13:57:39.286830 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m13:57:39.287455 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m13:57:39.290114 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:57:39.290395 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace  temporary view btc.btc_schema.stg_btc_outputs__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


with flattened as (
select
    t.hashkey,
    t.block_number,
    t.block_timestamp,
    t.is_coinbase,
    op.value:value::FLOAT as output_value,
    op.value:address::STRING as output_address 

from btc.btc_schema.stg_btc as t,
lateral flatten(input => t.outputs) as op
where op.value is not null



    and t.block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc_outputs)


)

select hashkey,
    block_number,
    block_timestamp,
    is_coinbase,
    output_value,
    output_address
from flattened
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m13:57:39.493118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m13:57:39.498803 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:57:39.499263 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:57:39.577108 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.077 seconds
[0m13:57:39.583763 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:57:39.584197 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:57:39.652165 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.067 seconds
[0m13:57:39.659594 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:57:39.659888 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table "BTC"."BTC_SCHEMA"."STG_BTC_OUTPUTS"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:57:39.719405 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.059 seconds
[0m13:57:39.728861 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m13:57:39.730650 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:57:39.731041 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:57:39.801019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.069 seconds
[0m13:57:39.801855 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:57:39.802456 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: insert into btc.btc_schema.stg_btc_outputs ("HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS")
    (
        select "HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS"
        from btc.btc_schema.stg_btc_outputs__dbt_tmp
    )


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */;
[0m13:57:40.450413 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.647 seconds
[0m13:57:40.450931 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:57:40.451184 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:57:40.547951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m13:57:40.554964 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc_outputs__dbt_tmp
[0m13:57:40.556005 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m13:57:40.556416 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: drop view if exists btc.btc_schema.stg_btc_outputs__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.stg_btc_outputs"} */
[0m13:57:40.669655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m13:57:40.674677 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model btc_schema.stg_btc_outputs ............. [[32mSUCCESS 0[0m in 1.39s]
[0m13:57:40.675653 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m13:57:40.677097 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m13:57:40.677673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_outputs, now model.btc.stg_btc_transactions)
[0m13:57:40.678045 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m13:57:40.681333 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m13:57:40.682782 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m13:57:40.683891 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m13:57:40.684538 [info ] [Thread-1 (]: 3 of 3 START sql table model btc_schema.whale_alerts ........................... [RUN]
[0m13:57:40.685304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_transactions, now model.btc.whale_alerts)
[0m13:57:40.685620 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m13:57:40.691331 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m13:57:40.692800 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m13:57:40.715197 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.whale_alerts"
[0m13:57:40.716917 [debug] [Thread-1 (]: Using snowflake connection "model.btc.whale_alerts"
[0m13:57:40.717260 [debug] [Thread-1 (]: On model.btc.whale_alerts: create or replace transient table btc.btc_schema.whale_alerts
    
    
    
    as (with  __dbt__cte__stg_btc_transactions as (


select * 
from btc.btc_schema.stg_btc_outputs 
where is_coinbase = false
), whales as (
    select
    output_address,
    sum(output_value) as total_sent,
    count(*) as transaction_count

from __dbt__cte__stg_btc_transactions

where output_value > 10

group by output_address
order by total_sent desc

),
latest_price as (
    select price
    from btc.btc_schema.btc_usd_max
    where to_date(replace(snapped_at, ' UTC', '')) = current_date()
)

select wh.output_address,
wh.total_sent,
wh.transaction_count,
(wh.total_sent * lp.price) as usd_value
from whales wh
cross join latest_price lp
order by wh.total_sent desc
    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.whale_alerts"} */;
[0m13:57:41.542160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m13:57:41.551676 [info ] [Thread-1 (]: 3 of 3 OK created sql table model btc_schema.whale_alerts ...................... [[32mSUCCESS 1[0m in 0.87s]
[0m13:57:41.552507 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m13:57:41.553971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:41.554372 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m13:57:41.554758 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m13:57:41.651902 [info ] [MainThread]: 
[0m13:57:41.653001 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 7.60 seconds (7.60s).
[0m13:57:41.654696 [debug] [MainThread]: Command end result
[0m13:57:41.681236 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m13:57:41.683605 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m13:57:41.689475 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m13:57:41.689860 [info ] [MainThread]: 
[0m13:57:41.690210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:41.690477 [info ] [MainThread]: 
[0m13:57:41.690747 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:57:41.693745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.144332, "process_in_blocks": "0", "process_kernel_time": 0.251046, "process_mem_max_rss": "166903808", "process_out_blocks": "0", "process_user_time": 1.643324}
[0m13:57:41.694202 [debug] [MainThread]: Command `dbt run` succeeded at 13:57:41.694123 after 8.14 seconds
[0m13:57:41.694531 [debug] [MainThread]: Flushing usage events
[0m14:04:00.706487 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:04:00.719446 | f578bbea-6cce-4b82-8888-dbbd249b08b7 ==============================
[0m14:04:00.719446 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:04:00.720046 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'quiet': 'False', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'profiles_dir': '/Users/mac/.dbt', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'invocation_command': 'dbt run --select whale_alerts', 'log_format': 'default'}
[0m14:04:00.948579 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:04:01.020840 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:04:01.138748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:04:01.139050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:04:01.217196 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:04:01.218265 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:04:01.225813 [info ] [MainThread]: Found 4 models, 2 data tests, 1 seed, 1 source, 480 macros
[0m14:04:01.226621 [info ] [MainThread]: 
[0m14:04:01.226830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:01.227000 [info ] [MainThread]: 
[0m14:04:01.227264 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:01.227709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m14:04:01.256794 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m14:04:01.257076 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc"} */
[0m14:04:01.257251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:04.452556 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.195 seconds
[0m14:04:04.460788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m14:04:04.474785 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m14:04:04.475292 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m14:04:04.578746 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.103 seconds
[0m14:04:04.585884 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m14:04:04.586455 [info ] [Thread-1 (]: 1 of 1 START sql table model btc_schema.whale_alerts ........................... [RUN]
[0m14:04:04.586894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.whale_alerts)
[0m14:04:04.587219 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m14:04:04.597800 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m14:04:04.603277 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m14:04:04.604026 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m14:04:04.626901 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.whale_alerts"
[0m14:04:04.628338 [debug] [Thread-1 (]: Using snowflake connection "model.btc.whale_alerts"
[0m14:04:04.628842 [debug] [Thread-1 (]: On model.btc.whale_alerts: create or replace transient table btc.btc_schema.whale_alerts
    
    
    
    as (with  __dbt__cte__stg_btc_transactions as (


select * 
from btc.btc_schema.stg_btc_outputs 
where is_coinbase = false
), whales as (
    select
    output_address,
    sum(output_value) as total_sent,
    count(*) as transaction_count

from __dbt__cte__stg_btc_transactions

where output_value > 10

group by output_address
order by total_sent desc

),
latest_price as (
    select price
    from btc.btc_schema.btc_usd_max
    where to_date(replace(snapped_at, ' UTC', '')) = current_date()
)

select wh.output_address,
wh.total_sent,
wh.transaction_count,


wh.total_sent * (
    select price
    from btc.btc_schema.btc_usd_max
    where to_date(replace(snapped_at, ' UTC', '')) >= current_date()
)

 as usd_value
from whales wh
cross join latest_price lp
order by wh.total_sent desc
    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "node_id": "model.btc.whale_alerts"} */;
[0m14:04:05.697554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.068 seconds
[0m14:04:05.727301 [info ] [Thread-1 (]: 1 of 1 OK created sql table model btc_schema.whale_alerts ...................... [[32mSUCCESS 1[0m in 1.14s]
[0m14:04:05.727961 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m14:04:05.728997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:05.729329 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m14:04:05.729614 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m14:04:05.820693 [info ] [MainThread]: 
[0m14:04:05.821334 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m14:04:05.822195 [debug] [MainThread]: Command end result
[0m14:04:05.843956 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:04:05.845701 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:04:05.850675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m14:04:05.850959 [info ] [MainThread]: 
[0m14:04:05.851276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:05.851512 [info ] [MainThread]: 
[0m14:04:05.851754 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:04:05.854350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.176638, "process_in_blocks": "0", "process_kernel_time": 0.222167, "process_mem_max_rss": "165068800", "process_out_blocks": "0", "process_user_time": 1.443177}
[0m14:04:05.854710 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:05.854647 after 5.18 seconds
[0m14:04:05.854971 [debug] [MainThread]: Flushing usage events
=======
>>>>>>> main
[0m14:28:55.335688 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:28:55.372599 | b70cfe37-f9b6-46ee-b6a9-5e0d8883d4fe ==============================
[0m14:28:55.372599 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:28:55.384474 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'empty': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/mac/.dbt', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target production', 'debug': 'False'}
[0m14:28:57.161138 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:28:57.262328 [debug] [MainThread]: checksum: 6e971fb8f28f41d820cb7f06b169a74aff7bfe6a0f8ef8a3f3d3ce2d4daff49b, vars: {}, profile: , target: production, version: 1.10.11
[0m14:28:57.323261 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:28:57.323601 [debug] [MainThread]: previous checksum: 6e971fb8f28f41d820cb7f06b169a74aff7bfe6a0f8ef8a3f3d3ce2d4daff49b, current checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9
[0m14:28:57.832183 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "stg_btc_outputs".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("stg_btc_outputs").
  
  To fix this, change the name of one of these resources:
  - model.btc.stg_btc_outputs (models/staging/stg_btc_outputs.sql)
  - model.btc.stg_btc_outputs (models/stg_btc_outputs.sql)
[0m14:28:57.834583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.525792, "process_in_blocks": "0", "process_kernel_time": 0.705027, "process_mem_max_rss": "166363136", "process_out_blocks": "0", "process_user_time": 2.869008}
[0m14:28:57.834956 [debug] [MainThread]: Command `dbt run` failed at 14:28:57.834904 after 2.53 seconds
[0m14:28:57.835184 [debug] [MainThread]: Flushing usage events
[0m14:31:06.333249 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:31:06.345343 | 6ce7edd0-f54e-4343-a0ae-c1e7680d71e2 ==============================
[0m14:31:06.345343 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:31:06.345875 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/mac/.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --target production', 'fail_fast': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'introspect': 'True', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'printer_width': '80'}
[0m14:31:06.564940 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:31:06.638204 [debug] [MainThread]: checksum: 6e971fb8f28f41d820cb7f06b169a74aff7bfe6a0f8ef8a3f3d3ce2d4daff49b, vars: {}, profile: , target: production, version: 1.10.11
[0m14:31:06.696356 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:31:06.698064 [debug] [MainThread]: previous checksum: 6e971fb8f28f41d820cb7f06b169a74aff7bfe6a0f8ef8a3f3d3ce2d4daff49b, current checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9
[0m14:31:07.449050 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:31:07.450354 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:31:07.528772 [info ] [MainThread]: Found 4 models, 1 seed, 2 data tests, 1 source, 480 macros
[0m14:31:07.529794 [info ] [MainThread]: 
[0m14:31:07.530019 [info ] [MainThread]: Concurrency: 1 threads (target='production')
[0m14:31:07.530200 [info ] [MainThread]: 
[0m14:31:07.530499 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:31:07.532817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m14:31:07.575194 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m14:31:07.575456 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "connection_name": "list_btc"} */
[0m14:31:07.575652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:11.089244 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.513 seconds
[0m14:31:11.092751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_schema)
[0m14:31:11.106536 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m14:31:11.106945 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "connection_name": "list_btc_btc_schema"} */;
[0m14:31:11.511359 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.404 seconds
[0m14:31:11.520362 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m14:31:11.521132 [info ] [Thread-1 (]: 1 of 3 START sql incremental model btc_schema.stg_btc .......................... [RUN]
[0m14:31:11.521735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m14:31:11.522194 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m14:31:11.533500 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m14:31:11.534616 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m14:31:11.573959 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:31:11.574373 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace  temporary view btc.btc_schema.stg_btc__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


select * from btc.btc_schema.btc



    where block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc)


  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */;
[0m14:31:12.020034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m14:31:12.032233 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:31:12.032714 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:31:12.164051 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.131 seconds
[0m14:31:12.172321 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:31:12.173115 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_schema.stg_btc
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:31:12.238700 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.065 seconds
[0m14:31:12.252729 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:31:12.253375 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table "BTC"."BTC_SCHEMA"."STG_BTC"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:31:12.341769 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.088 seconds
[0m14:31:12.379050 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m14:31:12.380742 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:31:12.381091 [debug] [Thread-1 (]: On model.btc.stg_btc: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */;
[0m14:31:12.503597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m14:31:12.504715 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:31:12.505377 [debug] [Thread-1 (]: On model.btc.stg_btc: merge into btc.btc_schema.stg_btc as DBT_INTERNAL_DEST
        using btc.btc_schema.stg_btc__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.hashkey = DBT_INTERNAL_DEST.hashkey))

    
    when matched then update set
        "HASHKEY" = DBT_INTERNAL_SOURCE."HASHKEY","BLOCK_HASH" = DBT_INTERNAL_SOURCE."BLOCK_HASH","BLOCK_NUMBER" = DBT_INTERNAL_SOURCE."BLOCK_NUMBER","BLOCK_TIMESTAMP" = DBT_INTERNAL_SOURCE."BLOCK_TIMESTAMP","FEE" = DBT_INTERNAL_SOURCE."FEE","INPUT_VALUE" = DBT_INTERNAL_SOURCE."INPUT_VALUE","OUTPUT_BTC" = DBT_INTERNAL_SOURCE."OUTPUT_BTC","FEE_PER_BYTE" = DBT_INTERNAL_SOURCE."FEE_PER_BYTE","IS_COINBASE" = DBT_INTERNAL_SOURCE."IS_COINBASE","OUTPUTS" = DBT_INTERNAL_SOURCE."OUTPUTS"
    

    when not matched then insert
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")
    values
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */;
[0m14:31:14.054514 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.548 seconds
[0m14:31:14.055908 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:31:14.056480 [debug] [Thread-1 (]: On model.btc.stg_btc: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:31:14.250911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m14:31:14.264433 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc__dbt_tmp
[0m14:31:14.272639 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:31:14.273067 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists btc.btc_schema.stg_btc__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:31:14.403130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m14:31:14.434402 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model btc_schema.stg_btc ..................... [[32mSUCCESS 0[0m in 2.91s]
[0m14:31:14.434880 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m14:31:14.435374 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m14:31:14.435680 [info ] [Thread-1 (]: 2 of 3 START sql incremental model btc_schema.stg_btc_outputs .................. [RUN]
[0m14:31:14.435964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc, now model.btc.stg_btc_outputs)
[0m14:31:14.436150 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m14:31:14.438239 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m14:31:14.438628 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m14:31:14.440495 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:31:14.440712 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace  temporary view btc.btc_schema.stg_btc_outputs__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


with flattened as (
select
    t.hashkey,
    t.block_number,
    t.block_timestamp,
    t.is_coinbase,
    op.value:value::FLOAT as output_value,
    op.value:address::STRING as output_address 

from btc.btc_schema.stg_btc as t,
lateral flatten(input => t.outputs) as op
where op.value is not null



    and t.block_timestamp > (select max(block_timestamp) from btc.btc_schema.stg_btc_outputs)


)

select hashkey,
    block_number,
    block_timestamp,
    is_coinbase,
    output_value,
    output_address
from flattened
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */;
[0m14:31:14.661305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m14:31:14.663882 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:31:14.664198 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:31:14.754788 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.090 seconds
[0m14:31:14.757346 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:31:14.757605 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_schema.stg_btc_outputs
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:31:14.817177 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.059 seconds
[0m14:31:14.820044 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:31:14.820414 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table "BTC"."BTC_SCHEMA"."STG_BTC_OUTPUTS"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:31:14.902308 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.082 seconds
[0m14:31:14.910869 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m14:31:14.911978 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:31:14.912313 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:31:15.016326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m14:31:15.017104 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:31:15.017699 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: insert into btc.btc_schema.stg_btc_outputs ("HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS")
    (
        select "HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS"
        from btc.btc_schema.stg_btc_outputs__dbt_tmp
    )


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */;
[0m14:31:15.275992 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.257 seconds
[0m14:31:15.277028 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:31:15.277582 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:31:15.388006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m14:31:15.393844 [debug] [Thread-1 (]: Applying DROP to: btc.btc_schema.stg_btc_outputs__dbt_tmp
[0m14:31:15.396957 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:31:15.397476 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: drop view if exists btc.btc_schema.stg_btc_outputs__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:31:15.668811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m14:31:15.674221 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model btc_schema.stg_btc_outputs ............. [[32mSUCCESS 0[0m in 1.24s]
[0m14:31:15.675287 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m14:31:15.676312 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m14:31:15.677006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_outputs, now model.btc.stg_btc_transactions)
[0m14:31:15.677534 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m14:31:15.681692 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m14:31:15.682907 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m14:31:15.683517 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m14:31:15.684087 [info ] [Thread-1 (]: 3 of 3 START sql table model btc_schema.whale_alerts ........................... [RUN]
[0m14:31:15.684527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_transactions, now model.btc.whale_alerts)
[0m14:31:15.685109 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m14:31:15.695608 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m14:31:15.696376 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m14:31:15.716964 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.whale_alerts"
[0m14:31:15.718380 [debug] [Thread-1 (]: Using snowflake connection "model.btc.whale_alerts"
[0m14:31:15.718740 [debug] [Thread-1 (]: On model.btc.whale_alerts: create or replace transient table btc.btc_schema.whale_alerts
    
    
    
    as (with  __dbt__cte__stg_btc_transactions as (


select * 
from btc.btc_schema.stg_btc_outputs 
where is_coinbase = false
), whales as (
    select
    output_address,
    sum(output_value) as total_sent,
    count(*) as transaction_count

from __dbt__cte__stg_btc_transactions

where output_value > 10

group by output_address
order by total_sent desc

),
latest_price as (
    select price
    from btc.btc_schema.btc_usd_max
    where to_date(replace(snapped_at, ' UTC', '')) = current_date()
)

select wh.output_address,
wh.total_sent,
wh.transaction_count,


wh.total_sent * (
    select price
    from btc.btc_schema.btc_usd_max
    where to_date(replace(snapped_at, ' UTC', '')) >= current_date()
)

 as usd_value
from whales wh
cross join latest_price lp
order by wh.total_sent desc
    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.whale_alerts"} */;
[0m14:31:17.379029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.660 seconds
[0m14:31:17.388329 [info ] [Thread-1 (]: 3 of 3 OK created sql table model btc_schema.whale_alerts ...................... [[32mSUCCESS 1[0m in 1.70s]
[0m14:31:17.389204 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m14:31:17.390520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:17.390897 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m14:31:17.391280 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m14:31:17.489904 [info ] [MainThread]: 
[0m14:31:17.490690 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 9.96 seconds (9.96s).
[0m14:31:17.492148 [debug] [MainThread]: Command end result
[0m14:31:17.517410 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:31:17.519009 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:31:17.523687 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m14:31:17.523972 [info ] [MainThread]: 
[0m14:31:17.524272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:17.524512 [info ] [MainThread]: 
[0m14:31:17.524751 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:31:17.527153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.220265, "process_in_blocks": "0", "process_kernel_time": 0.287262, "process_mem_max_rss": "175456256", "process_out_blocks": "0", "process_user_time": 2.385818}
[0m14:31:17.527571 [debug] [MainThread]: Command `dbt run` succeeded at 14:31:17.527498 after 11.22 seconds
[0m14:31:17.527841 [debug] [MainThread]: Flushing usage events
[0m14:34:07.933251 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:34:07.945719 | 1a9752f8-97a8-42d2-b1ff-c47ae880af64 ==============================
[0m14:34:07.945719 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:34:07.946233 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run --target production', 'no_print': 'None', 'profiles_dir': '/Users/mac/.dbt', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'warn_error': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'target_path': 'None', 'version_check': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False'}
[0m14:34:08.177737 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:34:08.250165 [debug] [MainThread]: checksum: 6e971fb8f28f41d820cb7f06b169a74aff7bfe6a0f8ef8a3f3d3ce2d4daff49b, vars: {}, profile: , target: production, version: 1.10.11
[0m14:34:08.307203 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:34:09.058728 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:34:09.060065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:34:09.098132 [info ] [MainThread]: Found 4 models, 1 seed, 2 data tests, 1 source, 480 macros
[0m14:34:09.099115 [info ] [MainThread]: 
[0m14:34:09.099328 [info ] [MainThread]: Concurrency: 1 threads (target='production')
[0m14:34:09.099495 [info ] [MainThread]: 
[0m14:34:09.099754 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:09.101993 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m14:34:09.132974 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m14:34:09.133218 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "connection_name": "list_btc"} */
[0m14:34:09.133391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:12.329121 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.196 seconds
[0m14:34:12.331103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now create_btc_btc_prod)
[0m14:34:12.331947 [debug] [ThreadPool]: Creating schema "database: "btc"
schema: "btc_prod"
"
[0m14:34:12.335954 [debug] [ThreadPool]: Using snowflake connection "create_btc_btc_prod"
[0m14:34:12.336258 [debug] [ThreadPool]: On create_btc_btc_prod: create schema if not exists btc.btc_prod
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "connection_name": "create_btc_btc_prod"} */
[0m14:34:12.447148 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m14:34:12.468672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_btc_btc_prod, now list_btc_btc_prod)
[0m14:34:12.479639 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_prod"
[0m14:34:12.480361 [debug] [ThreadPool]: On list_btc_btc_prod: show objects in btc.btc_prod
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "connection_name": "list_btc_btc_prod"} */;
[0m14:34:12.581452 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.101 seconds
[0m14:34:12.586346 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m14:34:12.586900 [info ] [Thread-1 (]: 1 of 3 START sql incremental model btc_prod.stg_btc ............................ [RUN]
[0m14:34:12.587320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_prod, now model.btc.stg_btc)
[0m14:34:12.587630 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m14:34:12.594491 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m14:34:12.595396 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m14:34:12.636745 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m14:34:12.639788 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:34:12.640097 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace transient table btc.btc_prod.stg_btc
    
    
    
    as (-- including incremental logic to only load new data


select * from btc.btc_schema.btc


    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */;
[0m14:34:14.480093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.839 seconds
[0m14:34:14.493445 [debug] [Thread-1 (]: Applying DROP to: btc.btc_prod.stg_btc__dbt_tmp
[0m14:34:14.499518 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:34:14.500183 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists btc.btc_prod.stg_btc__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:34:15.225677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m14:34:15.247881 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model btc_prod.stg_btc ....................... [[32mSUCCESS 1[0m in 2.66s]
[0m14:34:15.248396 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m14:34:15.248986 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m14:34:15.249454 [info ] [Thread-1 (]: 2 of 3 START sql incremental model btc_prod.stg_btc_outputs .................... [RUN]
[0m14:34:15.249838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc, now model.btc.stg_btc_outputs)
[0m14:34:15.250118 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m14:34:15.252875 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m14:34:15.253506 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m14:34:15.256724 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m14:34:15.257695 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:34:15.257978 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace transient table btc.btc_prod.stg_btc_outputs
    
    
    
    as (-- including incremental logic to only load new data


with flattened as (
select
    t.hashkey,
    t.block_number,
    t.block_timestamp,
    t.is_coinbase,
    op.value:value::FLOAT as output_value,
    op.value:address::STRING as output_address 

from btc.btc_prod.stg_btc as t,
lateral flatten(input => t.outputs) as op
where op.value is not null



)

select hashkey,
    block_number,
    block_timestamp,
    is_coinbase,
    output_value,
    output_address
from flattened
    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */;
[0m14:34:16.727102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.468 seconds
[0m14:34:16.731904 [debug] [Thread-1 (]: Applying DROP to: btc.btc_prod.stg_btc_outputs__dbt_tmp
[0m14:34:16.733212 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:34:16.733939 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: drop view if exists btc.btc_prod.stg_btc_outputs__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:34:16.793814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.059 seconds
[0m14:34:16.798194 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model btc_prod.stg_btc_outputs ............... [[32mSUCCESS 1[0m in 1.55s]
[0m14:34:16.799071 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m14:34:16.800231 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m14:34:16.801041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_outputs, now model.btc.stg_btc_transactions)
[0m14:34:16.801666 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m14:34:16.805743 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m14:34:16.807084 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m14:34:16.807972 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m14:34:16.808674 [info ] [Thread-1 (]: 3 of 3 START sql table model btc_prod.whale_alerts ............................. [RUN]
[0m14:34:16.809303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_transactions, now model.btc.whale_alerts)
[0m14:34:16.809701 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m14:34:16.818842 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m14:34:16.819912 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m14:34:16.828785 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.whale_alerts"
[0m14:34:16.830482 [debug] [Thread-1 (]: Using snowflake connection "model.btc.whale_alerts"
[0m14:34:16.831136 [debug] [Thread-1 (]: On model.btc.whale_alerts: create or replace transient table btc.btc_prod.whale_alerts
    
    
    
    as (with  __dbt__cte__stg_btc_transactions as (


select * 
from btc.btc_prod.stg_btc_outputs 
where is_coinbase = false
), whales as (
    select
    output_address,
    sum(output_value) as total_sent,
    count(*) as transaction_count

from __dbt__cte__stg_btc_transactions

where output_value > 10

group by output_address
order by total_sent desc

),
latest_price as (
    select price
    from btc.btc_prod.btc_usd_max
    where to_date(replace(snapped_at, ' UTC', '')) = current_date()
)

select wh.output_address,
wh.total_sent,
wh.transaction_count,


wh.total_sent * (
    select price
    from btc.btc_prod.btc_usd_max
    where to_date(replace(snapped_at, ' UTC', '')) >= current_date()
)

 as usd_value
from whales wh
cross join latest_price lp
order by wh.total_sent desc
    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.whale_alerts"} */;
[0m14:34:16.927396 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bf1c72-0004-e2d2-0000-0000f195c365
[0m14:34:16.928009 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'BTC.BTC_PROD.BTC_USD_MAX' does not exist or not authorized.
[0m14:34:16.932047 [debug] [Thread-1 (]: Database Error in model whale_alerts (models/marts/whale_alerts.sql)
  002003 (42S02): SQL compilation error:
  Object 'BTC.BTC_PROD.BTC_USD_MAX' does not exist or not authorized.
  compiled code at target/run/btc/models/marts/whale_alerts.sql
[0m14:34:16.932828 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model btc_prod.whale_alerts .................... [[31mERROR[0m in 0.12s]
[0m14:34:16.933371 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m14:34:16.933869 [debug] [Thread-4 (]: Marking all children of 'model.btc.whale_alerts' to be skipped because of status 'error'.  Reason: Database Error in model whale_alerts (models/marts/whale_alerts.sql)
  002003 (42S02): SQL compilation error:
  Object 'BTC.BTC_PROD.BTC_USD_MAX' does not exist or not authorized.
  compiled code at target/run/btc/models/marts/whale_alerts.sql.
[0m14:34:16.935481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:16.935806 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m14:34:16.936053 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m14:34:17.028593 [info ] [MainThread]: 
[0m14:34:17.029229 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 7.93 seconds (7.93s).
[0m14:34:17.030175 [debug] [MainThread]: Command end result
[0m14:34:17.051476 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:34:17.053303 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:34:17.057423 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m14:34:17.057696 [info ] [MainThread]: 
[0m14:34:17.057991 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:34:17.058227 [info ] [MainThread]: 
[0m14:34:17.058736 [error] [MainThread]: [31mFailure in model whale_alerts (models/marts/whale_alerts.sql)[0m
[0m14:34:17.059194 [error] [MainThread]:   Database Error in model whale_alerts (models/marts/whale_alerts.sql)
  002003 (42S02): SQL compilation error:
  Object 'BTC.BTC_PROD.BTC_USD_MAX' does not exist or not authorized.
  compiled code at target/run/btc/models/marts/whale_alerts.sql
[0m14:34:17.059456 [info ] [MainThread]: 
[0m14:34:17.059725 [info ] [MainThread]:   compiled code at target/compiled/btc/models/marts/whale_alerts.sql
[0m14:34:17.059958 [info ] [MainThread]: 
[0m14:34:17.060210 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:34:17.063208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.156229, "process_in_blocks": "0", "process_kernel_time": 0.267895, "process_mem_max_rss": "174981120", "process_out_blocks": "0", "process_user_time": 2.178222}
[0m14:34:17.063652 [debug] [MainThread]: Command `dbt run` failed at 14:34:17.063585 after 9.16 seconds
[0m14:34:17.063956 [debug] [MainThread]: Flushing usage events
[0m14:35:24.768951 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:35:24.780131 | ee8de7a0-fcd4-4f2b-8286-e17e5c0027be ==============================
[0m14:35:24.780131 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:35:24.780687 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'no_print': 'None', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt seed --target production', 'use_experimental_parser': 'False', 'log_format': 'default', 'partial_parse': 'True', 'empty': 'None', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'quiet': 'False', 'profiles_dir': '/Users/mac/.dbt'}
[0m14:35:24.993821 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:35:25.067360 [debug] [MainThread]: checksum: 6e971fb8f28f41d820cb7f06b169a74aff7bfe6a0f8ef8a3f3d3ce2d4daff49b, vars: {}, profile: , target: production, version: 1.10.11
[0m14:35:25.163814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:25.164100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:25.240767 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:35:25.241977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:35:25.251097 [info ] [MainThread]: Found 4 models, 1 seed, 2 data tests, 1 source, 480 macros
[0m14:35:25.252058 [info ] [MainThread]: 
[0m14:35:25.252289 [info ] [MainThread]: Concurrency: 1 threads (target='production')
[0m14:35:25.252469 [info ] [MainThread]: 
[0m14:35:25.252756 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:35:25.253205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m14:35:25.283580 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m14:35:25.283847 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "connection_name": "list_btc"} */
[0m14:35:25.284038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:28.479009 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.195 seconds
[0m14:35:28.488539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_prod)
[0m14:35:28.502796 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_prod"
[0m14:35:28.503173 [debug] [ThreadPool]: On list_btc_btc_prod: show objects in btc.btc_prod
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "connection_name": "list_btc_btc_prod"} */;
[0m14:35:28.588042 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.084 seconds
[0m14:35:28.601529 [debug] [Thread-1 (]: Began running node seed.btc.btc_usd_max
[0m14:35:28.603202 [info ] [Thread-1 (]: 1 of 1 START seed file btc_prod.btc_usd_max .................................... [RUN]
[0m14:35:28.604094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_prod, now seed.btc.btc_usd_max)
[0m14:35:28.609288 [debug] [Thread-1 (]: Began compiling node seed.btc.btc_usd_max
[0m14:35:28.609623 [debug] [Thread-1 (]: Began executing node seed.btc.btc_usd_max
[0m14:35:28.706537 [debug] [Thread-1 (]: Using snowflake connection "seed.btc.btc_usd_max"
[0m14:35:28.706904 [debug] [Thread-1 (]: On seed.btc.btc_usd_max: create table btc.btc_prod.btc_usd_max (snapped_at text,price float8,market_cap float8,total_volume float8)
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "seed.btc.btc_usd_max"} */
[0m14:35:28.898865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m14:35:28.970962 [debug] [Thread-1 (]: Using snowflake connection "seed.btc.btc_usd_max"
[0m14:35:28.971310 [debug] [Thread-1 (]: On seed.btc.btc_usd_max: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "seed.btc.btc_usd_max"} */
[0m14:35:29.041712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m14:35:29.249934 [debug] [Thread-1 (]: Using snowflake connection "seed.btc.btc_usd_max"
[0m14:35:29.250157 [debug] [Thread-1 (]: On seed.btc.btc_usd_max: insert into btc.btc_prod.btc_usd_max (snapped_at, price, market_cap, total_volume) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,...
[0m14:35:30.914198 [debug] [Thread-1 (]: SQL status: SUCCESS 4524 in 1.664 seconds
[0m14:35:30.915769 [debug] [Thread-1 (]: Using snowflake connection "seed.btc.btc_usd_max"
[0m14:35:30.916368 [debug] [Thread-1 (]: On seed.btc.btc_usd_max: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "seed.btc.btc_usd_max"} */
[0m14:35:31.231262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m14:35:31.241525 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.btc.btc_usd_max"
[0m14:35:31.267055 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file btc_prod.btc_usd_max ................................ [[32mINSERT 4524[0m in 2.66s]
[0m14:35:31.267568 [debug] [Thread-1 (]: Finished running node seed.btc.btc_usd_max
[0m14:35:31.268471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:31.268782 [debug] [MainThread]: Connection 'seed.btc.btc_usd_max' was left open.
[0m14:35:31.269037 [debug] [MainThread]: On seed.btc.btc_usd_max: Close
[0m14:35:31.358617 [info ] [MainThread]: 
[0m14:35:31.359164 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m14:35:31.359827 [debug] [MainThread]: Command end result
[0m14:35:31.378231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:35:31.379798 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:35:31.384355 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m14:35:31.384605 [info ] [MainThread]: 
[0m14:35:31.384891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:31.385110 [info ] [MainThread]: 
[0m14:35:31.385332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:35:31.387227 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.644668, "process_in_blocks": "0", "process_kernel_time": 0.245789, "process_mem_max_rss": "170065920", "process_out_blocks": "0", "process_user_time": 1.812411}
[0m14:35:31.387537 [debug] [MainThread]: Command `dbt seed` succeeded at 14:35:31.387484 after 6.65 seconds
[0m14:35:31.387773 [debug] [MainThread]: Flushing usage events
[0m14:35:35.373122 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:35:35.384050 | e8774396-0d66-42fc-b8b4-51a19b397fc9 ==============================
[0m14:35:35.384050 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:35:35.384627 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --target production', 'profiles_dir': '/Users/mac/.dbt', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'log_format': 'default'}
[0m14:35:35.601363 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:35:35.672544 [debug] [MainThread]: checksum: 6e971fb8f28f41d820cb7f06b169a74aff7bfe6a0f8ef8a3f3d3ce2d4daff49b, vars: {}, profile: , target: production, version: 1.10.11
[0m14:35:35.768051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:35.768330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:35.842856 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:35:35.843994 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:35:35.851012 [info ] [MainThread]: Found 4 models, 1 seed, 2 data tests, 1 source, 480 macros
[0m14:35:35.851960 [info ] [MainThread]: 
[0m14:35:35.852203 [info ] [MainThread]: Concurrency: 1 threads (target='production')
[0m14:35:35.852383 [info ] [MainThread]: 
[0m14:35:35.852646 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:35:35.854776 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc'
[0m14:35:35.883857 [debug] [ThreadPool]: Using snowflake connection "list_btc"
[0m14:35:35.884107 [debug] [ThreadPool]: On list_btc: show terse schemas in database btc
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "connection_name": "list_btc"} */
[0m14:35:35.884270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:36.247413 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.363 seconds
[0m14:35:36.251768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_btc, now list_btc_btc_prod)
[0m14:35:36.267261 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_prod"
[0m14:35:36.267745 [debug] [ThreadPool]: On list_btc_btc_prod: show objects in btc.btc_prod
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "connection_name": "list_btc_btc_prod"} */;
[0m14:35:36.367452 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.099 seconds
[0m14:35:36.373475 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m14:35:36.374160 [info ] [Thread-1 (]: 1 of 3 START sql incremental model btc_prod.stg_btc ............................ [RUN]
[0m14:35:36.374737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_prod, now model.btc.stg_btc)
[0m14:35:36.375183 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m14:35:36.389515 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m14:35:36.390309 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m14:35:36.428379 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:35:36.428721 [debug] [Thread-1 (]: On model.btc.stg_btc: create or replace  temporary view btc.btc_prod.stg_btc__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


select * from btc.btc_schema.btc



    where block_timestamp > (select max(block_timestamp) from btc.btc_prod.stg_btc)


  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */;
[0m14:35:36.667165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m14:35:36.681367 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:35:36.681982 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_prod.stg_btc__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:35:36.754817 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.072 seconds
[0m14:35:36.762624 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:35:36.763127 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table btc.btc_prod.stg_btc
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:35:36.845009 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.081 seconds
[0m14:35:36.856487 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:35:36.857036 [debug] [Thread-1 (]: On model.btc.stg_btc: describe table "BTC"."BTC_PROD"."STG_BTC"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:35:36.934224 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.076 seconds
[0m14:35:36.970047 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc"
[0m14:35:36.971528 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:35:36.971849 [debug] [Thread-1 (]: On model.btc.stg_btc: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */;
[0m14:35:37.050925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m14:35:37.051425 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:35:37.051855 [debug] [Thread-1 (]: On model.btc.stg_btc: merge into btc.btc_prod.stg_btc as DBT_INTERNAL_DEST
        using btc.btc_prod.stg_btc__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.hashkey = DBT_INTERNAL_DEST.hashkey))

    
    when matched then update set
        "HASHKEY" = DBT_INTERNAL_SOURCE."HASHKEY","BLOCK_HASH" = DBT_INTERNAL_SOURCE."BLOCK_HASH","BLOCK_NUMBER" = DBT_INTERNAL_SOURCE."BLOCK_NUMBER","BLOCK_TIMESTAMP" = DBT_INTERNAL_SOURCE."BLOCK_TIMESTAMP","FEE" = DBT_INTERNAL_SOURCE."FEE","INPUT_VALUE" = DBT_INTERNAL_SOURCE."INPUT_VALUE","OUTPUT_BTC" = DBT_INTERNAL_SOURCE."OUTPUT_BTC","FEE_PER_BYTE" = DBT_INTERNAL_SOURCE."FEE_PER_BYTE","IS_COINBASE" = DBT_INTERNAL_SOURCE."IS_COINBASE","OUTPUTS" = DBT_INTERNAL_SOURCE."OUTPUTS"
    

    when not matched then insert
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")
    values
        ("HASHKEY", "BLOCK_HASH", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "FEE", "INPUT_VALUE", "OUTPUT_BTC", "FEE_PER_BYTE", "IS_COINBASE", "OUTPUTS")


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */;
[0m14:35:38.346414 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.294 seconds
[0m14:35:38.347353 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:35:38.347841 [debug] [Thread-1 (]: On model.btc.stg_btc: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:35:38.586241 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m14:35:38.599321 [debug] [Thread-1 (]: Applying DROP to: btc.btc_prod.stg_btc__dbt_tmp
[0m14:35:38.607374 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc"
[0m14:35:38.607856 [debug] [Thread-1 (]: On model.btc.stg_btc: drop view if exists btc.btc_prod.stg_btc__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc"} */
[0m14:35:38.709398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m14:35:38.732855 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model btc_prod.stg_btc ....................... [[32mSUCCESS 0[0m in 2.36s]
[0m14:35:38.733453 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m14:35:38.734154 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m14:35:38.734565 [info ] [Thread-1 (]: 2 of 3 START sql incremental model btc_prod.stg_btc_outputs .................... [RUN]
[0m14:35:38.734937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc, now model.btc.stg_btc_outputs)
[0m14:35:38.735232 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m14:35:38.738383 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m14:35:38.739120 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m14:35:38.742125 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:35:38.742464 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: create or replace  temporary view btc.btc_prod.stg_btc_outputs__dbt_tmp
  
  
  
  
  as (
    -- including incremental logic to only load new data


with flattened as (
select
    t.hashkey,
    t.block_number,
    t.block_timestamp,
    t.is_coinbase,
    op.value:value::FLOAT as output_value,
    op.value:address::STRING as output_address 

from btc.btc_prod.stg_btc as t,
lateral flatten(input => t.outputs) as op
where op.value is not null



    and t.block_timestamp > (select max(block_timestamp) from btc.btc_prod.stg_btc_outputs)


)

select hashkey,
    block_number,
    block_timestamp,
    is_coinbase,
    output_value,
    output_address
from flattened
  )
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */;
[0m14:35:38.952238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m14:35:38.958467 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:35:38.959286 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_prod.stg_btc_outputs__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:35:39.050064 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.090 seconds
[0m14:35:39.057915 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:35:39.058716 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table btc.btc_prod.stg_btc_outputs
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:35:39.125133 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.066 seconds
[0m14:35:39.131413 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:35:39.131974 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: describe table "BTC"."BTC_PROD"."STG_BTC_OUTPUTS"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:35:39.203313 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.071 seconds
[0m14:35:39.218232 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.stg_btc_outputs"
[0m14:35:39.220080 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:35:39.220624 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:35:39.303860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m14:35:39.305661 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:35:39.306440 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: insert into btc.btc_prod.stg_btc_outputs ("HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS")
    (
        select "HASHKEY", "BLOCK_NUMBER", "BLOCK_TIMESTAMP", "IS_COINBASE", "OUTPUT_VALUE", "OUTPUT_ADDRESS"
        from btc.btc_prod.stg_btc_outputs__dbt_tmp
    )


/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */;
[0m14:35:40.392492 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.085 seconds
[0m14:35:40.394175 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:35:40.394994 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:35:40.611153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m14:35:40.616387 [debug] [Thread-1 (]: Applying DROP to: btc.btc_prod.stg_btc_outputs__dbt_tmp
[0m14:35:40.617452 [debug] [Thread-1 (]: Using snowflake connection "model.btc.stg_btc_outputs"
[0m14:35:40.617932 [debug] [Thread-1 (]: On model.btc.stg_btc_outputs: drop view if exists btc.btc_prod.stg_btc_outputs__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.stg_btc_outputs"} */
[0m14:35:40.735690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m14:35:40.740706 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model btc_prod.stg_btc_outputs ............... [[32mSUCCESS 0[0m in 2.01s]
[0m14:35:40.742188 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m14:35:40.743261 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m14:35:40.744189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_outputs, now model.btc.stg_btc_transactions)
[0m14:35:40.744766 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m14:35:40.749146 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m14:35:40.750630 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m14:35:40.751341 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m14:35:40.751859 [info ] [Thread-1 (]: 3 of 3 START sql table model btc_prod.whale_alerts ............................. [RUN]
[0m14:35:40.752318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_transactions, now model.btc.whale_alerts)
[0m14:35:40.752675 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m14:35:40.763907 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m14:35:40.764805 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m14:35:40.785798 [debug] [Thread-1 (]: Writing runtime sql for node "model.btc.whale_alerts"
[0m14:35:40.787186 [debug] [Thread-1 (]: Using snowflake connection "model.btc.whale_alerts"
[0m14:35:40.787485 [debug] [Thread-1 (]: On model.btc.whale_alerts: create or replace transient table btc.btc_prod.whale_alerts
    
    
    
    as (with  __dbt__cte__stg_btc_transactions as (


select * 
from btc.btc_prod.stg_btc_outputs 
where is_coinbase = false
), whales as (
    select
    output_address,
    sum(output_value) as total_sent,
    count(*) as transaction_count

from __dbt__cte__stg_btc_transactions

where output_value > 10

group by output_address
order by total_sent desc

),
latest_price as (
    select price
    from btc.btc_prod.btc_usd_max
    where to_date(replace(snapped_at, ' UTC', '')) = current_date()
)

select wh.output_address,
wh.total_sent,
wh.transaction_count,


wh.total_sent * (
    select price
    from btc.btc_prod.btc_usd_max
    where to_date(replace(snapped_at, ' UTC', '')) >= current_date()
)

 as usd_value
from whales wh
cross join latest_price lp
order by wh.total_sent desc
    )

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "production", "node_id": "model.btc.whale_alerts"} */;
[0m14:35:41.828621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.041 seconds
[0m14:35:41.831349 [info ] [Thread-1 (]: 3 of 3 OK created sql table model btc_prod.whale_alerts ........................ [[32mSUCCESS 1[0m in 1.08s]
[0m14:35:41.832003 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m14:35:41.833258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:41.833617 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m14:35:41.833919 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m14:35:41.938310 [info ] [MainThread]: 
[0m14:35:41.939056 [info ] [MainThread]: Finished running 2 incremental models, 1 table model in 0 hours 0 minutes and 6.09 seconds (6.09s).
[0m14:35:41.940431 [debug] [MainThread]: Command end result
[0m14:35:41.966887 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m14:35:41.973410 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m14:35:41.983996 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m14:35:41.984363 [info ] [MainThread]: 
[0m14:35:41.987923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:41.988961 [info ] [MainThread]: 
[0m14:35:41.989861 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:35:41.993756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6453443, "process_in_blocks": "0", "process_kernel_time": 0.244936, "process_mem_max_rss": "166510592", "process_out_blocks": "0", "process_user_time": 1.6715}
[0m14:35:41.994634 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:41.994515 after 6.65 seconds
[0m14:35:41.995338 [debug] [MainThread]: Flushing usage events
[0m17:32:41.748403 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:32:41.765554 | ffcaa8e9-ce3c-4857-a2e4-ac8e022c4c31 ==============================
[0m17:32:41.765554 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:32:41.766107 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/mac/.dbt', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'quiet': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'empty': 'False', 'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs'}
[0m17:32:49.769984 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:32:49.854192 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m17:32:49.856750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.134762, "process_in_blocks": "0", "process_kernel_time": 0.293453, "process_mem_max_rss": "176046080", "process_out_blocks": "0", "process_user_time": 1.297481}
[0m17:32:49.857288 [debug] [MainThread]: Command `dbt run` failed at 17:32:49.857234 after 8.14 seconds
[0m17:32:49.857542 [debug] [MainThread]: Flushing usage events
[0m17:33:05.960701 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:33:05.971731 | eeb0bd18-2938-4ddc-a9f5-de46f283450c ==============================
[0m17:33:05.971731 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:33:05.972293 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'profiles_dir': '/Users/mac/.dbt', 'quiet': 'False', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'empty': 'None', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'partial_parse': 'True'}
[0m17:33:06.111578 [debug] [MainThread]: Set downloads directory='/var/folders/yt/m6lpgwx11h3dm6844cq8ssqr0000gn/T/dbt-downloads-u4tvmt3b'
[0m17:33:06.112258 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:33:06.326756 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:33:06.327976 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:33:06.456296 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:33:06.473619 [info ] [MainThread]: Updating lock file in file path: /Users/mac/Desktop/DE2025/btc/package-lock.yml
[0m17:33:06.476153 [debug] [MainThread]: Set downloads directory='/var/folders/yt/m6lpgwx11h3dm6844cq8ssqr0000gn/T/dbt-downloads-g7qne4p4'
[0m17:33:06.479353 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:33:06.918598 [info ] [MainThread]: Installed from version 1.3.1
[0m17:33:06.919067 [info ] [MainThread]: Up to date!
[0m17:33:06.921431 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9868995, "process_in_blocks": "0", "process_kernel_time": 0.202986, "process_mem_max_rss": "116899840", "process_out_blocks": "0", "process_user_time": 0.848764}
[0m17:33:06.921946 [debug] [MainThread]: Command `dbt deps` succeeded at 17:33:06.921872 after 0.99 seconds
[0m17:33:06.922216 [debug] [MainThread]: Flushing usage events
[0m17:36:18.861540 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:36:18.875020 | c82112e7-f1d6-4673-aa6f-c55d7067fb93 ==============================
[0m17:36:18.875020 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:36:18.875638 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'no_print': 'None', 'version_check': 'True', 'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'profiles_dir': '/Users/mac/.dbt', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False'}
[0m17:36:19.388445 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:36:19.484132 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:36:19.543134 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:36:19.543417 [debug] [MainThread]: previous checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, current checksum: 6e971fb8f28f41d820cb7f06b169a74aff7bfe6a0f8ef8a3f3d3ce2d4daff49b
[0m17:36:19.543592 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:36:19.543754 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:36:20.410773 [info ] [MainThread]: Found 4 models, 1 seed, 2 data tests, 1 source, 596 macros
[0m17:36:20.411850 [info ] [MainThread]: 
[0m17:36:20.412065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:20.412234 [info ] [MainThread]: 
[0m17:36:20.412488 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:36:20.414944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc_btc_schema'
[0m17:36:20.450323 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m17:36:20.450579 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m17:36:20.450747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:24.590396 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 4.139 seconds
[0m17:36:24.598418 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m17:36:24.599210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m17:36:24.599695 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m17:36:24.611615 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m17:36:24.612490 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m17:36:24.613136 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m17:36:24.613507 [debug] [Thread-1 (]: Began running node seed.btc.btc_usd_max
[0m17:36:24.613965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc, now seed.btc.btc_usd_max)
[0m17:36:24.614294 [debug] [Thread-1 (]: Began compiling node seed.btc.btc_usd_max
[0m17:36:24.617433 [debug] [Thread-1 (]: Began executing node seed.btc.btc_usd_max
[0m17:36:24.617985 [debug] [Thread-1 (]: Finished running node seed.btc.btc_usd_max
[0m17:36:24.618325 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m17:36:24.618675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.btc.btc_usd_max, now model.btc.stg_btc_outputs)
[0m17:36:24.618986 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m17:36:24.622147 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m17:36:24.622721 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m17:36:24.623209 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m17:36:24.623524 [debug] [Thread-1 (]: Began running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:36:24.623916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_outputs, now test.btc.not_null_stg_btc_HASHKEY.f1464799d5)
[0m17:36:24.624289 [debug] [Thread-1 (]: Began compiling node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:36:24.633077 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m17:36:24.633627 [debug] [Thread-1 (]: Began executing node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:36:24.634084 [debug] [Thread-1 (]: Finished running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:36:24.634376 [debug] [Thread-1 (]: Began running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:36:24.634740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.btc.not_null_stg_btc_HASHKEY.f1464799d5, now test.btc.unique_stg_btc_HASHKEY.3bc82edb0f)
[0m17:36:24.635062 [debug] [Thread-1 (]: Began compiling node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:36:24.639393 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m17:36:24.639888 [debug] [Thread-1 (]: Began executing node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:36:24.640310 [debug] [Thread-1 (]: Finished running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:36:24.640578 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m17:36:24.640863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.btc.unique_stg_btc_HASHKEY.3bc82edb0f, now model.btc.stg_btc_transactions)
[0m17:36:24.641113 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m17:36:24.642994 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m17:36:24.643562 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m17:36:24.643958 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m17:36:24.644274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_transactions, now model.btc.whale_alerts)
[0m17:36:24.644522 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m17:36:24.650447 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m17:36:24.650881 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m17:36:24.651274 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m17:36:24.651778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:24.651977 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m17:36:24.652171 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m17:36:24.769285 [debug] [MainThread]: Command end result
[0m17:36:24.857487 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:36:24.859411 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:36:24.863647 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m17:36:24.866352 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m17:36:24.866649 [info ] [MainThread]: Building catalog
[0m17:36:24.871854 [debug] [ThreadPool]: Acquiring new snowflake connection 'btc.information_schema'
[0m17:36:24.880454 [debug] [ThreadPool]: Using snowflake connection "btc.information_schema"
[0m17:36:24.880845 [debug] [ThreadPool]: On btc.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from btc.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'btc_usd_max' and upper("table_name") = upper('btc_usd_max')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'whale_alerts' and upper("table_name") = upper('whale_alerts')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'btc' and upper("table_name") = upper('btc')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'stg_btc' and upper("table_name") = upper('stg_btc')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'stg_btc_outputs' and upper("table_name") = upper('stg_btc_outputs')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from btc.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'btc_usd_max' and upper("table_name") = upper('btc_usd_max')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'whale_alerts' and upper("table_name") = upper('whale_alerts')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'btc' and upper("table_name") = upper('btc')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'stg_btc' and upper("table_name") = upper('stg_btc')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'stg_btc_outputs' and upper("table_name") = upper('stg_btc_outputs')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "btc.information_schema"} */
[0m17:36:24.881285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:28.793054 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 3.912 seconds
[0m17:36:28.818811 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/mac/Desktop/DE2025/btc/target/catalog.json
[0m17:36:28.837120 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:36:28.838543 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:36:28.838761 [info ] [MainThread]: Catalog written to /Users/mac/Desktop/DE2025/btc/target/catalog.json
[0m17:36:28.841810 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 10.007395, "process_in_blocks": "0", "process_kernel_time": 0.396323, "process_mem_max_rss": "218906624", "process_out_blocks": "0", "process_user_time": 2.743184}
[0m17:36:28.842191 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:36:28.842130 after 10.01 seconds
[0m17:36:28.842415 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:36:28.842587 [debug] [MainThread]: Connection 'btc.information_schema' was left open.
[0m17:36:28.842765 [debug] [MainThread]: On btc.information_schema: Close
[0m17:36:28.929028 [debug] [MainThread]: Flushing usage events
[0m17:38:05.780631 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:38:05.793155 | 9e95517e-49f2-486e-9d15-69d1f8d94c23 ==============================
[0m17:38:05.793155 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:38:05.793674 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/mac/.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'None', 'quiet': 'False', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True'}
[0m17:38:06.526774 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m17:38:06.529523 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m17:38:06.532498 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.77883524, "process_in_blocks": "0", "process_kernel_time": 0.191082, "process_mem_max_rss": "174882816", "process_out_blocks": "0", "process_user_time": 1.067122}
[0m17:38:06.533465 [debug] [MainThread]: Command `dbt docs serve` failed at 17:38:06.533379 after 0.78 seconds
[0m17:38:06.533793 [debug] [MainThread]: Flushing usage events
[0m17:40:10.518327 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:40:10.532810 | 70b82ccc-9a1e-4f88-8e98-b800f5e547af ==============================
[0m17:40:10.532810 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:40:10.533336 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/mac/.dbt', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs serve', 'fail_fast': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'partial_parse': 'True', 'printer_width': '80'}
[0m17:40:11.242913 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m17:40:11.246132 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m17:40:11.249524 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.7577448, "process_in_blocks": "0", "process_kernel_time": 0.196193, "process_mem_max_rss": "175046656", "process_out_blocks": "0", "process_user_time": 1.067812}
[0m17:40:11.250362 [debug] [MainThread]: Command `dbt docs serve` failed at 17:40:11.250288 after 0.76 seconds
[0m17:40:11.250672 [debug] [MainThread]: Flushing usage events
[0m17:41:02.406926 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:41:02.418117 | 7b3a44ed-ef55-4699-99cf-f0465ab98bac ==============================
[0m17:41:02.418117 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:41:02.418628 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'empty': 'None', 'quiet': 'False', 'profiles_dir': '/Users/mac/.dbt', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'log_format': 'default'}
[0m17:41:02.962551 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m17:41:02.964359 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m17:41:02.967067 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.5866012, "process_in_blocks": "0", "process_kernel_time": 0.160853, "process_mem_max_rss": "176209920", "process_out_blocks": "0", "process_user_time": 1.061417}
[0m17:41:02.967906 [debug] [MainThread]: Command `dbt docs serve` failed at 17:41:02.967831 after 0.59 seconds
[0m17:41:02.968243 [debug] [MainThread]: Flushing usage events
[0m17:41:36.699323 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:41:36.713248 | 148f86e4-2aec-49bc-8ec4-e70ff19931b7 ==============================
[0m17:41:36.713248 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:41:36.713876 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'profiles_dir': '/Users/mac/.dbt', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True'}
[0m17:41:37.446116 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m17:41:37.449039 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m17:41:37.452270 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.7802713, "process_in_blocks": "0", "process_kernel_time": 0.207411, "process_mem_max_rss": "176226304", "process_out_blocks": "0", "process_user_time": 1.068675}
[0m17:41:37.453054 [debug] [MainThread]: Command `dbt docs serve` failed at 17:41:37.452986 after 0.78 seconds
[0m17:41:37.453353 [debug] [MainThread]: Flushing usage events
[0m17:42:53.096531 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:42:53.109094 | 6a03507e-3b04-465c-8f51-a6c20f247640 ==============================
[0m17:42:53.109094 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:42:53.109633 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'profiles_dir': '/Users/mac/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'empty': 'None', 'invocation_command': 'dbt docs generate', 'warn_error': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True'}
[0m17:42:53.673615 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:42:53.765663 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m17:42:53.848515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:42:53.848745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:42:53.887589 [info ] [MainThread]: Found 4 models, 1 seed, 2 data tests, 1 source, 596 macros
[0m17:42:53.888603 [info ] [MainThread]: 
[0m17:42:53.888822 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:53.888989 [info ] [MainThread]: 
[0m17:42:53.889254 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:42:53.891420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_btc_btc_schema'
[0m17:42:53.927008 [debug] [ThreadPool]: Using snowflake connection "list_btc_btc_schema"
[0m17:42:53.927235 [debug] [ThreadPool]: On list_btc_btc_schema: show objects in btc.btc_schema
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "list_btc_btc_schema"} */;
[0m17:42:53.927399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:57.197630 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.270 seconds
[0m17:42:57.206424 [debug] [Thread-1 (]: Began running node model.btc.stg_btc
[0m17:42:57.207182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_btc_btc_schema, now model.btc.stg_btc)
[0m17:42:57.207682 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc
[0m17:42:57.228856 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc"
[0m17:42:57.229682 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc
[0m17:42:57.230304 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc
[0m17:42:57.230650 [debug] [Thread-1 (]: Began running node seed.btc.btc_usd_max
[0m17:42:57.231092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc, now seed.btc.btc_usd_max)
[0m17:42:57.231437 [debug] [Thread-1 (]: Began compiling node seed.btc.btc_usd_max
[0m17:42:57.233056 [debug] [Thread-1 (]: Began executing node seed.btc.btc_usd_max
[0m17:42:57.233564 [debug] [Thread-1 (]: Finished running node seed.btc.btc_usd_max
[0m17:42:57.233868 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_outputs
[0m17:42:57.234182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.btc.btc_usd_max, now model.btc.stg_btc_outputs)
[0m17:42:57.234452 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_outputs
[0m17:42:57.237348 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_outputs"
[0m17:42:57.237895 [debug] [Thread-1 (]: Began executing node model.btc.stg_btc_outputs
[0m17:42:57.238366 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_outputs
[0m17:42:57.238650 [debug] [Thread-1 (]: Began running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:42:57.238984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_outputs, now test.btc.not_null_stg_btc_HASHKEY.f1464799d5)
[0m17:42:57.239294 [debug] [Thread-1 (]: Began compiling node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:42:57.247602 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.not_null_stg_btc_HASHKEY.f1464799d5"
[0m17:42:57.248137 [debug] [Thread-1 (]: Began executing node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:42:57.248554 [debug] [Thread-1 (]: Finished running node test.btc.not_null_stg_btc_HASHKEY.f1464799d5
[0m17:42:57.248813 [debug] [Thread-1 (]: Began running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:42:57.249085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.btc.not_null_stg_btc_HASHKEY.f1464799d5, now test.btc.unique_stg_btc_HASHKEY.3bc82edb0f)
[0m17:42:57.249319 [debug] [Thread-1 (]: Began compiling node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:42:57.253201 [debug] [Thread-1 (]: Writing injected SQL for node "test.btc.unique_stg_btc_HASHKEY.3bc82edb0f"
[0m17:42:57.253646 [debug] [Thread-1 (]: Began executing node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:42:57.254029 [debug] [Thread-1 (]: Finished running node test.btc.unique_stg_btc_HASHKEY.3bc82edb0f
[0m17:42:57.254278 [debug] [Thread-1 (]: Began running node model.btc.stg_btc_transactions
[0m17:42:57.254523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.btc.unique_stg_btc_HASHKEY.3bc82edb0f, now model.btc.stg_btc_transactions)
[0m17:42:57.254741 [debug] [Thread-1 (]: Began compiling node model.btc.stg_btc_transactions
[0m17:42:57.256624 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.stg_btc_transactions"
[0m17:42:57.257136 [debug] [Thread-1 (]: Finished running node model.btc.stg_btc_transactions
[0m17:42:57.257557 [debug] [Thread-1 (]: Began running node model.btc.whale_alerts
[0m17:42:57.257827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.btc.stg_btc_transactions, now model.btc.whale_alerts)
[0m17:42:57.258060 [debug] [Thread-1 (]: Began compiling node model.btc.whale_alerts
[0m17:42:57.264436 [debug] [Thread-1 (]: Writing injected SQL for node "model.btc.whale_alerts"
[0m17:42:57.264855 [debug] [Thread-1 (]: Began executing node model.btc.whale_alerts
[0m17:42:57.265235 [debug] [Thread-1 (]: Finished running node model.btc.whale_alerts
[0m17:42:57.265701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:57.265907 [debug] [MainThread]: Connection 'model.btc.whale_alerts' was left open.
[0m17:42:57.266111 [debug] [MainThread]: On model.btc.whale_alerts: Close
[0m17:42:57.391284 [debug] [MainThread]: Command end result
[0m17:42:57.528202 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:42:57.530609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:42:57.534471 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mac/Desktop/DE2025/btc/target/run_results.json
[0m17:42:57.537478 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m17:42:57.537677 [info ] [MainThread]: Building catalog
[0m17:42:57.542374 [debug] [ThreadPool]: Acquiring new snowflake connection 'btc.information_schema'
[0m17:42:57.550733 [debug] [ThreadPool]: Using snowflake connection "btc.information_schema"
[0m17:42:57.551145 [debug] [ThreadPool]: On btc.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from btc.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'whale_alerts' and upper("table_name") = upper('whale_alerts')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'btc_usd_max' and upper("table_name") = upper('btc_usd_max')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'stg_btc_outputs' and upper("table_name") = upper('stg_btc_outputs')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'btc' and upper("table_name") = upper('btc')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'stg_btc' and upper("table_name") = upper('stg_btc')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from btc.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'whale_alerts' and upper("table_name") = upper('whale_alerts')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'btc_usd_max' and upper("table_name") = upper('btc_usd_max')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'stg_btc_outputs' and upper("table_name") = upper('stg_btc_outputs')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'btc' and upper("table_name") = upper('btc')

                )
             or 
                (
                    
    "table_schema" ilike 'btc_schema' and upper("table_schema") = upper('btc_schema')

                    and 
    "table_name" ilike 'stg_btc' and upper("table_name") = upper('stg_btc')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "btc", "target_name": "dev", "connection_name": "btc.information_schema"} */
[0m17:42:57.551438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:04.200342 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 6.649 seconds
[0m17:43:04.233654 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/mac/Desktop/DE2025/btc/target/catalog.json
[0m17:43:04.252733 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mac/Desktop/DE2025/btc/target/manifest.json
[0m17:43:04.253960 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mac/Desktop/DE2025/btc/target/semantic_manifest.json
[0m17:43:04.254181 [info ] [MainThread]: Catalog written to /Users/mac/Desktop/DE2025/btc/target/catalog.json
[0m17:43:04.257176 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 11.187336, "process_in_blocks": "0", "process_kernel_time": 0.312989, "process_mem_max_rss": "209649664", "process_out_blocks": "0", "process_user_time": 1.847274}
[0m17:43:04.257553 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:43:04.257494 after 11.19 seconds
[0m17:43:04.257787 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:43:04.257975 [debug] [MainThread]: Connection 'btc.information_schema' was left open.
[0m17:43:04.258162 [debug] [MainThread]: On btc.information_schema: Close
[0m17:43:04.336912 [debug] [MainThread]: Flushing usage events
[0m17:43:17.132494 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:43:17.145542 | 476403e2-c985-4271-ae47-2b4df4bc4bd6 ==============================
[0m17:43:17.145542 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:43:17.146119 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'partial_parse': 'True', 'printer_width': '80', 'no_print': 'None', 'fail_fast': 'False', 'empty': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/mac/.dbt', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'log_cache_events': 'False'}
[0m17:43:17.796417 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m17:43:17.801654 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m17:43:17.805988 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.71039426, "process_in_blocks": "0", "process_kernel_time": 0.171316, "process_mem_max_rss": "175308800", "process_out_blocks": "0", "process_user_time": 1.074209}
[0m17:43:17.807889 [debug] [MainThread]: Command `dbt docs serve` failed at 17:43:17.807433 after 0.71 seconds
[0m17:43:17.808615 [debug] [MainThread]: Flushing usage events
[0m17:43:59.729204 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 17:43:59.741546 | eff951da-d790-4ea0-9f7c-3f64a422d66f ==============================
[0m17:43:59.741546 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:43:59.742097 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/mac/.dbt', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'log_format': 'default', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/Users/mac/Desktop/DE2025/btc/logs', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m17:46:00.415350 [error] [MainThread]: Encountered an error:

[0m17:46:00.423703 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mac/Desktop/DE2025/btc/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mac/.pyenv/versions/3.12.0/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:46:00.430501 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 120.727005, "process_in_blocks": "0", "process_kernel_time": 0.176999, "process_mem_max_rss": "175390720", "process_out_blocks": "0", "process_user_time": 1.08315}
[0m17:46:00.432383 [debug] [MainThread]: Command `dbt docs serve` failed at 17:46:00.432185 after 120.73 seconds
[0m17:46:00.433005 [debug] [MainThread]: Flushing usage events
